## App 业务流程框架图
![](https://main.qcloudimg.com/raw/7066697c0e2183276117dbb2b323f14f.png)
蓝色部分主要由腾讯云发，部署在腾讯侧；橙色部分由调用方开发对接，部署在调用方。

## SDK 功能

* 版本号：V3.0
* 功能：实名核身整体流程，包括身份证 OCR 识别和活体检测功能。

### 文件说明
SDK 包含了以下文件：
**AuthSDK.framework**：封装了实名认证的流程，包括了身份证 OCR 识别和活体检测功能。
**opencv2.framework和ULSMultitrackeriOSSDK.framework**：人脸识别引擎 SDK。
**face_shape.ref、ULSGPUAssets.bin、authsdk.bundle、 ULSFaceTrackerAssets.bundle**：均为资源文件
协议文件在 AuthSDK.framework/authsdk.bundle/protocol.txt 中，可以根据需要修改。其他资源文件，如首页 banner 也可根据需求替换 authsdk.bundle 中图片。


## 接入流程
### 1 . 添加 framework
将 AuthSDK.framework 拷贝到项目根目录 Framework 中（目录可自定义），在 TARGETS-Build Phases-Link Binary with Libraries 点击“+”，弹出添加列表后，点击“Add Other…”,从Framework文件夹中添加AuthSDK.framework到工程中。同理，添加SDK中的所有文件添加到工程中。
![图片](https://main.qcloudimg.com/raw/d606a2f1e2190a37b9cab56a9ab264bf.png)

保证下图中的内部framework添加到工程中：
![图片](https://main.qcloudimg.com/raw/efef4d0a70e51506fe00db6b33b35be3.png)

### 2 . 添加 AuthSDK.framework 中资源文件
在工程界面右键弹出菜单中选择"Add Files To..."，从文件夹Framework->AuthSDK.framework中将资源文件authsdk.bundle添加到工程中。
![图片](https://main.qcloudimg.com/raw/faeef2472185a9912c9e4f02a8d23177.png)

### 3 . 添加需要的编译选项
在TARGETS-Build Settings-Other Linker Flags 中添加如下内容： -ObjC 。
C++ Language Dialect设置为C++11 [-std=c++11]
C++ Standard Library设置为libc++
![图片](https://main.qcloudimg.com/raw/f04e1c91f36c3785329adb9d99f5d409.png)

### 4 . 添加权限声明
在工程 info.plist 中增加如下字串：
```
<key>NSPhotoLibraryUsageDescription</key>
<string>需要您的同意才能读取照片库</string>
<key>NSCameraUsageDescription</key>
<string>需要您的同意才能使用摄像头</string>
<key>NSMicrophoneUsageDescription</key>
<string>需要您的同意才能使用麦克风</string>
```
Xcode9 以上版本需要添加如下字符串：
```
<key>NSPhotoLibraryAddUsageDescription</key>
<string>需要您的同意才能读取照片库</string>
```
如果您使用 HTTP 访问服务器时，需要做如下配置（否则不需要）：
```
<key>NSAppTransportSecurity</key>
<dict>
		<key>NSAllowsArbitraryLoads</key>
	    <true/>
</dict>
```

   	 	
### 5 . 初始化 SDK 接口
在程序中导入 SDK，并初始化，设置分配的 APPID。
```objc
#import <AuthSDK/AuthSDK.h>
```
目前 Demo 中使用的是测试 URL，接入时可修改成正式服务URL（传 nil 时，使用测试服务器）
```objc
@property (nonatomic) AuthSDK * sdk;
```

```objc
_sdk = [[AuthSDK alloc] initWithServerURL:nil]
[_sdk setAppId:@"4396" appSecretKey:@"416df0300bd4043fb4d4df5c00b3e280"];

```

### 6 . 获取 signature
接入方需要在服务端实现获取 signature 的接口，客户端通过接口拉取到 signature，在下面调用SDK接口的时候需要传入。


### 7 . 调用实名认证接口
```objc
[_sdk startAuth:nil name:_nameText.text idNum:_idNumText.text token:_token.text parent:self delegate:self signature:_signature isSecondVerify:YES];
```