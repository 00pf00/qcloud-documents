## 背景

弹性MapReduce产品于2019年9月10日对主机以及组件服务监控项进行了升级，新增了“弹性MapReduce”策略类型，覆盖了数百监控项指标，您可以在云监控**“弹性MapReduce**[[1\]](#_msocom_1) [[v2\]](#_msocom_2) **”**策略类型下配置告警策略。**原“EMR”策略类型将于2021年03月30日23:00下线，已配置的“EMR”策略类型将全部失效**。后续新增告警策略，请配置在“弹性MapReduce”策略类型下。

 

表：“EMR”与“弹性MapReduce”策略类型对比

| 策略类型      | 指标覆盖                                       | 支持与维护                              |
| ------------- | ---------------------------------------------- | --------------------------------------- |
| EMR           | 1.集群告警（12个指标）   2.子机告警（8个指标） | 将于2021年03月30日23:00下线，且不在维护 |
| 弹性MapReduce | 1.主机监控   2.服务监控  3.集群监控            | 已于2019年9月10日上线，持续维护         |

 

注：“弹性MapReduce”策略类型已覆盖原有EMR策略所有指标，详情见附件：新老指标对照表[[3\]](#_msocom_3) 

## 二、告警策略迁移说明

在”EMR”策略类型下线时，系统会自动将原有的“EMR”策略类型的告警策略后台迁移至新的”弹性MapReduce“策略类型下，具体规则和验证方法见后续通知。

注：不排除极个别用户存在需要手动迁移的特殊情况。

**手动迁移具体步骤如下:**

\1. 梳理已有告警指标以及告警策略

登陆云监控控制台，在告警策略的高级筛选中按【策略类型】选择“EMR”策略类型对应的告警策略类型，查询对应类别下的告警策略，并下载原“EMR”策略类型下已配置的告警策略。**
** ![img](file:///C:/Users/V_JING~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.jpg)

 

\2. 配置新告警策略

在集群列表中点击【告警配置】,跳转入【告警策略】页面后，点击“新建”，在策略类型中选择“弹性MapReduce”，根据第1步梳理下载的策略进行告警配置，最新告警配置方法可查阅官网文档[【配置告警】](https://cloud.tencent.com/document/product/589/14626)。

\3. 验证新的告警策略

验证“弹性 MapReduce”告警策略是否启用并能成功触发告警。在【指标告警】设置一个最小触发阈值，选择设定【接收组或接收人】，以及选择接受渠道【邮件、短信、微信】，达到测试验证效果，例如：内存区域占比_SO,统计周期五分钟当阈值大于等于1%，持续1周期即触发告警，每五分钟告警一次。

\4. 清理旧告警策略

新策略类型验证完成后删除原“EMR”策略类型下配置的告警策略。在告警策略筛选条件中按【策略类型】选择“EMR”策略类型对应的告警策略进行查询，对照步骤1中下载策略表，进行删除。

![img](file:///C:/Users/V_JING~1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.jpg)

 

如果您在迁移中遇到问题，请及时提交工单进行处理。

 

附件：新老指标对照表

| **原有策略类型** | **指标/事件告警** | **原有指标/事件告警名称**    | **新策略类型**                  | **新指标/事件名称**       |
| ---------------- | ----------------- | ---------------------------- | ------------------------------- | ------------------------- |
| EMR-集群告警     | 指标告警          | HDFS已用存储空间             | 弹性 MapReduce-HDFS-概览        | 集群存储容量_CapacityUsed |
| 指标告警         | HDFS存储利用率    | 弹性 MapReduce-HDFS-概览     | HDFS存储空间使用率_capacityused |                           |
| 指标告警         | YARN应用阻塞数    | 弹性 MapReduce-YARN-概览     | Applications_pending            |                           |
| 指标告警         | YARN应用失败数    | 弹性 MapReduce-YARN-概览     | Applications_failed             |                           |
| 指标告警         | 集群CPU已分配核数 | 弹性 MapReduce-YARN-概览     | Cores_allocatedVirtualCores     |                           |
| 指标告警         | 集群CPU利用率     | 弹性 MapReduce-YARN-概览     | CPU使用率_usageRatio            |                           |
| 指标告警         | 集群内存可用空间  | 弹性 MapReduce-YARN-概览     | Memory_availableMB              |                           |
| 指标告警         | 集群内存利用率    | 弹性 MapReduce-YARN-概览     | 内存使用率_usageRatio           |                           |
| 指标告警         | 集群容器阻塞数    | 弹性 MapReduce-YARN-概览     | Containers_containersPending    |                           |
| 指标告警         | Hbase请求量       | 弹性 MapReduce-HBASE-概览    | 集群总请求数量_clusterRequests  |                           |
| 指标告警         | Hbase同步耗时     | 不在维护                     |                                 |                           |
| 指标告警         | Hbase同步log长度  | 不在维护                     |                                 |                           |
| 事件告警         | 节点监控心跳丢失  | 弹性 MapReduce-主机监控-网络 | 节点监控心跳丢失                |                           |
| 事件告警         | 进程重启          | 弹性 MapReduce-主机监控-进程 | 进程OOM                         |                           |
| EMR-子机告警     | 指标告警          | 磁盘利用率                   | 弹性 MapReduce-主机监控-磁盘    | 磁盘空间使用率_used_all   |
| 指标告警         | 内存使用量        | 弹性 MapReduce-主机监控-内存 | 内存使用情况_MemFree            |                           |
| 指标告警         | 机器重启          | 不在维护                     | 机器重启                        |                           |
| 指标告警         | 内存利用率        | 弹性 MapReduce-主机监控-内存 | 内存使用占比_used_percent       |                           |
| 指标告警         | CPU利用率         | 弹性 MapReduce-主机监控-CPU  | CPU使用率_idle                  |                           |
| 指标告警         | 内网入包量        | 不在维护                     |                                 |                           |
| 指标告警         | 内网出包量        | 不在维护                     |                                 |                           |
| 指标告警         | TCP连接数         | 弹性 MapReduce-主机监控-网络 | TCP连接数                       |                           |





------



链接到云监控文档的 弹性MapReduce



 [[v2\]](#_msoanchor_2)https://cloud.tencent.com/document/product/248/44797



链接到文末的附件对照表

