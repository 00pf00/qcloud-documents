## 创建和管理集群

流计算 Oceanus 支持共享集群和独享集群两种模式：

1. 共享集群：由系统管理，用户不用关注它的创建和管理维护。
2. 独享集群：用户自己创建，由系统独立部署在一个专属的VPC中，和其他租户完全隔离，具有极高的安全性，只有独享集群才能支持提交JAR作业。

本文介绍内容仅针对独享集群。



## 创建集群

使用流计算 Oceanus 的独享模式，首先你需要创建一个独享集群。

1. 在流计算 Oceanus 管理控制台的左侧导航栏，点击【集群管理】，进入【我的集群】页面。

   ![我的集群](https://main.qcloudimg.com/raw/cc48be0f0efe03e019fa7d3120efe64f.png)

2. 在【我的集群】页面点击【新建集群】，进入到【创建集群】界面。

   ![创建集群](https://main.qcloudimg.com/raw/53ff22286152c8cec73e02e898cf84a6.png)

   根据你的需求情况，选择相应的配置，点击【立即购买】完成购买，相关参数说明如下：

   | 参数        | 说明                                                         |
   | ----------- | ------------------------------------------------------------ |
   | 地域/可用区 | 建议选择最近的地域，可降低访问时延、提高访问速度。详细说明请参见 [地域和可用区](https://cloud.tencent.com/document/product/215/20057) |
   | 集群名称    | 自定义集群名称                                               |
   | 集群描述    | 帮助识别此集群的描述                                         |
   | 计算资源    | 1CU = 1核4G，请根据你的计算需要选择                          |
   | VPC         | 这不是独享集群所放的VPC，而是独享集群将要访问的VPC。<br>独享集群会和所选VPC下对应的子网进行打通，来访问该网络下的资源和服务。<br>详细的网络架构请参见 [了解共享和独享集群（待加url）](xxx) |

3. 集群创建完成后，在【集群管理】页查看集群列表中你新建的集群，等待集群状态从“未初始化”变为“运行中“，则代表集群创建成功；目前集群创建是半自动的，通常在24小时内完成创建。



## 创建对等连接

1. 集群创建完成后，后台会自动帮你完成对等连接的创建工作，保证你的VPC与创建集群VPC的网络互通。点击【私有网络】，再点击【对等连接】，查看创建出来的对等连接如下。

   ![对等连接](https://main.qcloudimg.com/raw/8aceb54cdc1c09549885fc2acdcc222b.png)

2. 创建对等连接的同时，也会创建相关的安全组， 网络ACL, 以及添加相应的路由信息，以允许你的独享集群中的作业能访问你的VPC中的资源，如CKafka，TencentDB等。首先查看创建的安全组，点击【私有网络】，再点击【安全】、【安全组】查看新建出来的安全组如下。

   ![安全组](https://main.qcloudimg.com/raw/3e1ddb19c3b4d8b322d848e3d14c2d19.png)

   > ? 说明：如果你的VPC中的资源，由于IP出入站规则的限制导致集群中的作业无法访问，则将该安全组配置到资源上即可。

   其次查看创建出来的网络ACL规则，点击【私有网络】，再点击【安全】、【网络ACL】查看是否针对你的VPC设置网络ACL，如下。

   ![ACL](https://main.qcloudimg.com/raw/441256471711b02934e89df2f3117e89.png)

   在入站和出站规则中查看，是否有允许独占集群访问的规则，如下。

   ![出站规则](https://main.qcloudimg.com/raw/42a29f70729e30a8f44d2bc9ff3eb7dd.png)

   > ？说明：如果网络ACL中有关于用户VPC的限制，则创建对等连接的时候，会在对应的网络ACL中加入独占集群VPC的出站和入站访问规则，否则不会修改网络ACL；

   最后查看创建出来的路由策略，点击【私有网络】，再点击【路由表】，找到用户VPC对应的路由表，进入路由表，查看基于用户的对等连接创建出来的路由策略。

   ![路由表](https://main.qcloudimg.com/raw/a06f8c37f92871300258ef2ab54270e2.png)



## 查看集群详情

1. 查看集群详情

   在【我的集群】页面，点击想要查看的集群名称，可以进入到集群详情页面：

   ![集群详情](https://main.qcloudimg.com/raw/38065decad16b76590328987544556f2.png)

   相关参数如下：

   | 参数         | 说明                                                         |
   | ------------ | ------------------------------------------------------------ |
   | 集群名称     | 自定义集群名称                                               |
   | 集群描述     | 帮助识别此集群的描述                                         |
   | 计算资源(CU) | 集群空闲的CU / 集群总共拥有的CU                              |
   | 地域/可用区  | 此集群所在的地域/可用区                                      |
   | VPC          | 这是独享集群关联的VPC和子网，独享集群通过网络打通，访问该网络环境下的资源和服务，详细的网络架构可以查看[了解共享和独享集群（待加url）](xxx) |
   | 创建时间     | 集群创建时间                                                 |
   | 结束时间     | 集群付费的到期时间                                           |

2. 查看集群下的作业

   点击【集群作业】打开【集群作业】页面，这里展示了所有在此集群提交的作业。
