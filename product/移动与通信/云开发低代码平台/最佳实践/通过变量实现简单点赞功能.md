本文主要讲解如何对前端渲染的变量进行获取，并通过方法对变量值进行更新。 以区块中的卡片列表为例，实现点击点赞区域实现点赞数加一的功能，具体思路如下：
<dx-steps>
-创建数据源与模型变量，并替换当前卡片数据
-理解循环变量的真正含义
-创建点赞数变量自增与数据源更新的方法
-通过 Tap 事件对自定义方法进行触发
</dx-steps>


## 步骤1：创建卡片列表
1. 进入微搭控制台 > [**应用管理**](https://console.cloud.tencent.com/lowcode/app)  页面，单击**新建应用** > **从空白新建**，进入微搭编辑器。
![](https://qcloudimg.tencent-cloud.cn/raw/9840441a5d74837d526abc1ecdb2d8b8.png)
2. 单击左侧组件区的**区块**，单击下方的**卡片列表**区块并拖入编辑区中。
![](https://qcloudimg.tencent-cloud.cn/raw/7bb3bae4e96da53f4150a3e24527f744.png)


## 步骤2：理解循环变量的真正含义[](id:step2)
1. 找到点赞数对应的**文本组件**，进入右侧配置区的**数据**页面进行配置。
![](https://qcloudimg.tencent-cloud.cn/raw/286a09c35a0a53a282f6a1dbd445cdba.png)
2. 通过左侧大纲树可以看到，该组件上层的父级组件绑定了循环展示。
![](https://qcloudimg.tencent-cloud.cn/raw/eb55eb3a67ca451ce07a4384e82c204d.png)
单击**变量绑定按钮**，可以看到该组件绑定了上层父级组件的循环变量。
![](https://qcloudimg.tencent-cloud.cn/raw/a85f7cda25699c1c1cfacac5e980a4d6.png)
3. 绑定的循环变量其实就是将父级组件绑定的变量进行遍历，分别赋给每一个通过循环生成的卡片。以点赞数绑定的 `id16.like` 为例，等同于 **$page.dataset.state.cardList[index].like（index 为当前卡片对应的顺序标识）**。
![](https://qcloudimg.tencent-cloud.cn/raw/e684354454ffbc2711104a5a04cde729.png)

## 步骤3：创建数据源，并按照卡片格式进行字段创建与数据录入
1.由于实现点赞功能需要记录每一次更新后的点赞数，因此需要与后端数据源进行连接。
2.进入数据源管理进行自建数据源的创建，并根据区块自带的cardList变量设置数据源字段与模拟数据。
![](https://qcloudimg.tencent-cloud.cn/raw/73eb4d3856d29ba43573ab1bd01916e5.png)
![](https://qcloudimg.tencent-cloud.cn/raw/18fc8a11317cdaf12e771de691040562.png)
![](https://qcloudimg.tencent-cloud.cn/raw/774175b61df54d7cb2315157926ece8a.png)
3.回到编辑器，创建模型变量与数据源进行连接。
![](https://qcloudimg.tencent-cloud.cn/raw/3364fd676794d8e19047e8e77c0e6c88.png)
4.使用模型变量替换当前卡片的绑定数据。
![](https://qcloudimg.tencent-cloud.cn/raw/5f7a89280a2e958b0bece5f9c6bcb3cd.png)
![](https://qcloudimg.tencent-cloud.cn/raw/b928388d9df3bbf85ebc45f2eb8dfacb.png)
![](https://qcloudimg.tencent-cloud.cn/raw/e6e1c3f27793d71d66cdc4ee44d89cc9.png)

>! 由图片可见，示例中创建的模型变量标识为dianzan，因此下文实现点赞的自定义方法皆以该标识为标准，您在实际操作过程中可根据自己的标识名称进行对应的调整

## 步骤4：创建自定义方法
该功能需要创建自定义方法控制变量并更新数据源来实现。
1.创建自定义方法，方法逻辑如下图所示
![](https://qcloudimg.tencent-cloud.cn/raw/40424f4a6b91e0101093c8e623f367e7.png)
![](https://qcloudimg.tencent-cloud.cn/raw/a228277ce5dd4dcdf00ddb89f42e2551.png)
![](https://qcloudimg.tencent-cloud.cn/raw/6341ceb1a5fc997939a31f7ac867a30a.png)

```

export default async function(e) {   //此处需要替换为function(e)来获取到当前点击事件所对应的对象value。 并且由于调用了数据源方法，我们在前缀添加async方法来处理异步。
var dz = e.data.target.dz++;  // 将对应对象的点赞值进行+1处理，并赋值给变量dz
var id = e.data.target._id; //获取当前选中对象的唯一标识，并赋值给变量id
let res = await app.cloud.dataSources.dianzan_qwnfr1g.wedaUpdate({    //调用数据源的wedaUpdate方法，传参id、dz
        _id: id.toString(),//由于入参需要字符串类型，因此添加toString方法进行类型转换
        dz: dz.toString()
    });
console.log(res) //打印返回结果


} 


} 


}
```


2.为点赞区域配置tap事件并调用上述的自定义方法
![](https://qcloudimg.tencent-cloud.cn/raw/c35d3b8132bc1544b60cfdcce9eee143.png)
![](https://qcloudimg.tencent-cloud.cn/raw/d8e773b921d54de735c2bda8af4c8190.png)
![](https://qcloudimg.tencent-cloud.cn/raw/5964af4b2f8f4ead7f568cec7b65ca4a.png)

3.绑定完成后，开启实时预览，测试点赞功能是否生效即可。
![](https://qcloudimg.tencent-cloud.cn/raw/7a2ca03ee1c6f9eb343422c0deda2d7f.png)
![](https://qcloudimg.tencent-cloud.cn/raw/c29f5a676f444b3fc60025bb0a0ac54c.png)
![](https://qcloudimg.tencent-cloud.cn/raw/5591821dfd853a84ff900abc90e78235.png)
