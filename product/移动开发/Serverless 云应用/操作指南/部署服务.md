# 部署服务

## 创建版本

首次部署服务，需要创建服务的第一个版本。按页面提示配置好版本信息，点击“开始部署”。

版本是一次部署所需信息的集合，包括镜像地址、服务端口、环境变量、自动扩缩容设置等；也是访问流量真正承载的实体，对应着一组配置信息相同的容器集群。

每一次升级服务，都需要创建一个新的版本。回滚时只需要将流量再次配置回旧版本即可。



## 版本管理

目前一个服务允许同时存在最多10个版本。版本名由 Serverless 云应用自动生成，格式为“服务名”+“序号”，序号按照创建顺序依次递增。（如：testservice-001, testservice-002等）。

不再使用的版本可以手动删除，已删除的版本不计入版本总数，但不会影响新建版本的序号。例如，删除掉版本"testservice-002"，再次新建的版本仍然会是“testservice-003”。



## 版本配置

### **基础配置** 

上传方式：支持本地代码/代码库拉取/镜像拉取三种方式。当选择方式不同时，相应的配置也会有变化。

服务端口：用户访问服务的端口，可自行设置，默认为80。注意此处配置的端口需与代码中设置的端口一致，否则会导致端口异常，服务不通。

流量策略：部署完成后是立刻开启100%流量，还是保持流量为0稍后再手动调整流量。



### **高级配置**

高级配置可使用默认配置，直接创建服务。如用户对自身业务有特殊需要可自行配置。

Dockerfile地址：当用户选择本地代码/代码库拉取方式构建服务，需要 Serverless 云应用先将代码构建为镜像，故需要用户提供Dockerfile文件。默认Dockerfile地址为根目录，用户也可根据自身项目进行修改。（请注意，当选择代码包 zip 上传时，Dockerfile的路径需与 zip 包内的路径一致，而非一定与当前文件夹的路径一致。路径错误可能导致构建失败。）

构建目录： 当 Serverless 云应用将用户代码构建为镜像时，构建目录默认为根目录。用户可根据自身项目进行修改。

内网IP/port：调用当前版本所需要的地址及服务端口。

规格：规格指集群中每个容器实例的配置。

副本个数：指当前服务版本后台对容器资源在扩缩容时可达到的最大实例数及最小实例数。副本个数的最大值决定对容器资源成本消耗的上限。

扩缩容条件：指当达到某个条件时，集群会创建/删除一个新的容器实例，直至容器数量达到副本个数的最小值或者最大值，停止自动扩缩容。

环境变量：用户所需的环境变量，以key value的形式可配置多个。



## 访问服务

部署成功之后，点击“访问服务”按钮，可以通过系统默认的域名查看您的服务。

若您需要绑定了自定义域名，请到“服务配置”选项卡中配置，然后通过您所绑定的域名访问服务。

