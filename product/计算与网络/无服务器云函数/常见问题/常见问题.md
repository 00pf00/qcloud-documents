## 通用类
### 什么是 SCF？
腾讯云云函数（Serverless Cloud Function，SCF）是腾讯云提供的无服务器（Serverless）执行环境。您只需编写简单的、目的单一的云函数，并将它与您的腾讯云基础设施及其他云服务产生的事件关联起来。
使用云函数时，用户只需关注自己的代码。腾讯云完全管理底层计算资源，包括服务器 CPU、内存、网络和其他配置/资源维护、代码部署、弹性伸缩、负载均衡、安全升级、资源运行情况监控等，用户只需使用平台支持的语言（目前支持 Python）提供代码。同时，这意味着您无法登录或管理服务器、无法自定义系统和环境。

代码在执行时将根据请求负载扩缩容，无需人工配置和介入即可满足不同情景下服务的可用性和稳定性，从每天几个请求到每秒数千个请求，都由云函数底层自行伸缩。云函数自动地在地域内的多个可用区部署，提供极高的容错性。用户只需为运行中的云函数付费，代码未运行时不产生任何费用。

您可以自定义何时运行您的代码，例如在 COS Bucket 上传或删除了文件时、应用程序通过 SDK 调用了代码时，或自行指定代码定期执行。因此，您可以使用云函数作为 COS 服务的数据处理触发程序，轻松实现 IFTTT 逻辑。也可构建灵活的定时自动化任务来覆盖手工完成的操作，轻松构建灵活可控的软件架构。

### 什么是无服务器计算？
借助无服务器计算，用户无需考虑服务器，即可构建和运行应用程序与服务。Serverless 并不代表没有了服务器，只是用户不再需要关心这些底层资源了。当然，这也意味着用户无法登录服务器，并且也不需要想办法优化它。开发者只需关心最核心的代码片段，从而跳过复杂的、无聊的其他工作。这些代码完全由事件触发（event-trigger），平台根据请求自动平行调整服务资源，拥有近乎无限的扩容能力，空闲时则没有任何资源在运行。代码运行无状态，可以轻易实现快速迭代、极速部署。SCF 是腾讯云无服务器计算的核心，支持您运行代码，且无需预置或管理服务器。

### 哪些事件可以触发 SCF 函数？
当前支持：手动触发（API）、定时触发、COS 触发、CMQ 触发、API网关触发等触发方式，后续更多触发方式正在持续添加中。

### SCF 支持哪些语言？
目前支持 Python 2.7&3.6，Node.js 6.10&8.9，Java 8，PHP 5&7，Golang。后续更多开发语言支持正在持续添加中。

### SCF 是否可以做 AI 推理？
可以，您还可以通过工单申请 GPU 来做推理的加速。带GPU的函数在被调用时，会给每个函数的运行环境分配一块 GPU 卡。

### 能否访问 SCF 运行所在的基础设施？
不能，SCF 会代您管理计算基础设施。

### SCF 如何隔离代码？

每个函数都运行在自己独有的环境中，拥有自己的资源和文件系统。SCF 使用与 CVM 相同的技术在基础设施和执行级别上提供安全性和隔离。

### SCF 是否可以和 CVM，TencentDB 等云上其他产品互访？
可以，您在创建云函数或修改云函数配置时，选择 VPC 配置，将云函数和 CVM，TencentDB 等部署到同一 VPC 即可。

### SCF 部署到 VPC 后，如何配置外网访问？
VPC 访问外网的方法有几种，可以参考 [NAT 网关文档介绍](https://cloud.tencent.com/document/product/552)。

## 函数类
### SCF 函数是什么？

云函数上运行的代码以 “SCF 函数” 的形式上传。每个函数都有相关的配置信息，如其名称、描述、资源要求等。代码必须以 “无状态” 样式编写，即应假设与底层计算基础设施无密切关系。本地文件系统访问、子进程等严格控制在云函数的生命周期内，且任何持续状态都应存储在外部可用的存储如 COS 或 TencentDB。SCF 函数可包含外部库，甚至是本机库。

### SCF 是否会重复使用函数实例？

为了提高性能，SCF 会在一定时间内保留您的函数实例，将其再用于服务后续请求。但您的代码不应假设此操作总是发生。

### 为何要保持 SCF 函数无状态？

保持函数的无状态性可使函数按需要尽可能多地启动多个实例，从而满足请求的速率。

### 如何使用 CLI 创建 SCF 函数？

您可以将代码（以及任何依赖库）打包为 zip 并使用 CLI 从您的本地环境上传 zip 文件，或将 zip 文件上传 COS Bucket 后，在创建函数时指定拉取代码 zip 包的 Bucket 名和文件名。CLI 详情可以参考 [SCF 命令行工具](https://cloud.tencent.com/document/product/583/33447)。

### 如何进行故障排除？

SCF 集成了日志功能，每次调用都会将该次调用的日志输出到控制台日志窗口中，日志记录了该函数每次使用时所消耗的资源、代码中的 log 及平台调用信息等，您可以轻松将故障排除相关的 log 语句插入到代码中。

### 通过上传 zip 包创建函数后，提示“函数服务创建失败，请重试”？

通常是函数的执行方法无法在zip包中找到对应的执行文件或函数入口，或压缩时包括了外层文件夹。执行方法格式为`a.b`，其中：a 是 py 文件的名称，b 是代码中的方法名。
如果用户上传的 zip 包在解压后的根目录下找不到名为`a.py`的文件，则会提示"函数代码无法显示，代码 zip 包中找不到执行方法指定的文件名"。

例如：文件结构如下
```
--RootFolder
----SecondFolder
------a.py
------thirdfolder
--------sth.json
```
压缩代码 zip 包时，如果压缩的是 SecondFolder，则会出现上述错误；需要选择 `a.py` 和 `thirdfoler` 进行压缩。

### 出现timeout时如何处理？

请先将超时时间设置为一个较大值（不超过300均可）再测试一遍，如果仍然超时，请检查您的代码 log 中是否存在过大的输入数据和计算量、无法跳出的循环、长时间的 sleep 等。

### 如何扩容？

用户不必关心函数扩缩容问题，SCF 平台会代您自动扩展。每当接收函数请求时，SCF 会快速定位空闲容量并运行您的代码。由于您的代码是无状态的，可以在需要时尽可能多地启动实例，而不会发生冗长的部署和配置延迟。

### 如何分配函数计算资源？

用户可以选择函数分配的内存量，CPU 和其他资源也会相应的按比例进行分配。例如，选择256MB的内存时，分配至函数的 CPU 约是分配128MB内存的两倍。

### 能否使用本地库？

可以。用户可以在函数代码中包含自己的代码库，并以 zip 包的形式上传至平台。

### 函数调用报错 “Resource limit exceed for function”？

通常是是函数并发触发了配额上限，可以通过公式“函数并发 = qps（每秒的请求数量）x 函数执行时间（秒）”来计算所需的函数并发数量；例如：qps = 100，函数执行时间 = 100ms，则实际需要的函数并发= 100 x 0.1 = 10；如果并发超了上限，您可以通过 [提交工单](https://console.cloud.tencent.com/workorder/category?level1_id=6&level2_id=668&source=0&data_title=%E6%97%A0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BA%91%E5%87%BD%E6%95%B0%20SCF&step=1) 来提升限制。

## 事件处理类
### 什么是事件源？

事件源是一类腾讯云服务或开发人员创建的应用程序，用于生成可触发云函数的事件。

### 有哪些事件源？

当前支持：手动触发（API）、定时触发、COS 触发、CMQ Topic 触发、API 网关触发、Ckafka 触发等触发方式，更多的触发方式正在持续添加中。

### 应用程序如何直接触发函数？

可以通过调用 SCF 的 Invoke API 直接触发函数。该函数的所有者或有调用该函数 Invoke API权限的帐号能直接调用。

### 函数响应事件的延迟如何？

SCF 在常规请求中可在毫秒级别内处理请求响应时间。但在函数创建、更新时，或如果它最近未被触发调用，延迟都将升高。

## 扩展性和可用性类
### 云函数的可用性如何？

SCF 云函数通过跨地域部署、复制和冗余来提供高可用性。

### 改动代码或配置时，云函数还可以使用吗？

可以。更新函数时会有短暂的窗口期，通常不到 1 分钟，在这期间请求将由旧函数代码或新函数代码实现。

### 单次运行的函数数量有没有限制？

SCF 可以支持大量函数实例并行。但是，我们有一项默认的安全阈值：每个函数最多 300 个并发执行量。此阈值可以通过提交工单进行提升。

### 函数在处理事件时发生故障会怎样？

如遇故障，进行同步调用的函数会返回异常信息。异步调用的函数将在后台自动重试 3 次。


## SCF 工具类安装相关

###  setuptools 版本过旧

表现：`error in scf setup command: 'install_requires' must be a string or list of strings containing valid project/version requirement specifiers`

解决方法：`pip install -U setuptools`

### 已存在的 distutils 安装包无法升级

表现：```Cannot uninstall 'PyYAML'. It is a distutils installed project and thus we cannot accurately determine which files belong to it which would lead to only a partial uninstall.```

解决方法： `pip install -I PyYAML==x.x.x`（在requirements.txt中查看具体版本）

### six 版本过低
表现：`pip "Cannot uninstall 'six'. It is a distutils installed project..."` 

解决方法： `sudo pip install six --upgrade --ignore-installed six` 

###  pytz 版本过低
表现：```uninstalling pytz : [error 1] Operation not permitted ...```

解决办法：`sudo pip install pytz --upgrade --ignore-installed six` 



## SCF 工具类使用相关

### yaml 配置文件内有多个函数描述时，如何指定函数进行本地调试

表现：`Error: You must provide a function identifier (function's Logical ID in the template). Possible options in your template: ['xxxB', 'xxxA']`

解决方法：调用 local invoke 命令时带有函数名，如 `scf local invoke -t template.yaml xxxA`

### 部署时出现 [SSL: CERTIFICATE_VERIFY_FAILED] 错误

表现：使用 deploy 时，部署函数失败，报`[SSL: CERTIFICATE_VERIFY_FAILED]` 证书验证错误，

问题原因：mac 10.12 + Python 3.6 及以上环境中，Python 不再读取系统路径证书，导致读取证书失败，调用腾讯云 云 API 部署时 SSL 验证失败。

解决方法：在 Python 安装目录下，执行 `Install Certificates.command` 脚本，会自动安装 certifi 包，解决证书问题。

## 运行环境类
### 环境内有可写空间吗？

可以，云函数在执行过程中，都拥有一块500MB的临时磁盘空间 /tmp，用户可以在执行代码时对该空间进行一些读写操作，但这部分数据在函数执行完成后不会保留。
>? 
> - 实例间的临时空间互相隔离，不共享，即每个实例均有独立的临时空间。
> - 运行环境内除 /tmp 目录下，其他均限制为只读。

### 可写空间写满后报错如何处理？

如果持续写入 /tmp 临时目录，并且由于调用频繁导致实例持续被使用，可能存在临时目录被写满，导致无法写入的问题。
请在代码中自行检查临时目录的写情况，并使用代码删除不再使用的临时文件以释放空间。

### 环境内的时区是什么？

云函数的运行环境内保持的是 UTC 时间，即0时区时间，和北京时间有8小时的时间差。

### 如何处理时区影响？

可以通过语言的时间处理相关库或代码包，识别 UTC 时间并转换为+8区北京时间，或通过设置环境变量 TZ=Asia/Shanghai 指定时区。

### 能否在我的函数代码中使用线程和进程？

能。用户可使用正常的语言和操作系统功能，如创建额外的线程和进程。分配至函数的资源，包括内存、执行时间、磁盘和网络，都通过其使用的线程/进程进行共享。

### 能否在我的函数代码中发起网络连接？

能。用户可使用正常的语言和操作系统功能，如发起 tcp、udp 的网络连接，能通过使用语言相关的库，连接数据库、访问 API 等操作。

### 有哪些限制适用于函数代码？

我们尽量不对正常的语言和操作系统活动施加限制，但有些活动仍被禁用。例如，入站网络连接将被阻止。

