## 操作场景

您在使用创建云函数（SCF）控制台或者 CLI 时，可能会需要操作部分其他产品的权限，例如 COS 触发器创建和删除所需的 COS 权限、API 网关触发器创建和删除所需的 API 网关权限、COS 代码文件的 zip 包读取权限等。

SCF 提供预设策略，用于授权访问 SCF 和其他关联资源，详情请参考 [用户策略更新说明](#Strategy)。SCF 会根据需要更新预设策略，以确保您有权限在 SCF 发布新功能后能够进行访问。同时，您也可以创建自定义策略来管理用户权限。
>!如果您当前是子用户/协作者，则需要主账号按照此步骤进行授权。授权完成后，主账号和子用户登录均可以使用云函数服务。
>
您在访问 SCF 控制台查看函数监控或函数运行期间，可能收到 `you are not authorized to perform xxx` 或其他未授权的提示。如下图所示：
![](https://main.qcloudimg.com/raw/eb90637f06dd0c454556a734189f0b8a.png)

您可以参照 [CAM 文档](https://cloud.tencent.com/document/product/598/38350) 自行创建策略。

也可以按照以下步骤，配置两条预设策略快速授权：
1. 登录 CAM 控制台，选择左侧导航栏中的【[角色](https://console.cloud.tencent.com/cam/role)】，并单击【新建角色】。如下图所示：
![](https://main.qcloudimg.com/raw/27710988b222ef1c16b77a526892ee0e.png)
2. 在弹出的“选择角色载体”窗口中，选择【腾讯云产品服务】进入“新建自定义角色”页面。
3. 在“新建自定义角色”页面中勾选【云函数】，并单击【下一步】。
4. 选择以下两条策略，并单击【下一步】。如下图所示：
![](https://main.qcloudimg.com/raw/79f4c3d9ed3909fd8a1676568e09ba68.png)
<table>
	<tr>
	<th>预设策略</th><th>功能</th>
	</tr>
	<tr>
	<td>QcloudSCFFullAccess</td><td>授予操作 SCF 和其他相关资源的全部访问权限</td>
	</tr>
	<tr>
	<td>QcloudSCFReadOnlyAccess</td><td>授予操作 SCF 和其他相关资源的只读访问权限</td>
	</tr>
</table>
5. 在“角色名称”中输入自定义角色名称（本文以 `SCF` 为例），并根据实际需求在“角色描述”中输入相关描述。
6. 单击【完成】即可创建成功。


## 附录
### 预制策略更新说明<spoan id="Strategy"></span>
SCF 于2019年12月完善了预设策略权限，针对预设策略 `QcloudSCFFullAccess` 和 `QcloudSCFReadOnlyAccess` 完成修改，针对配置角色 `SCF_QcsRole` 添加了 `QcloudAccessForScfRole` 策略。详情如下：
- 在预设策略 QcloudSCFFullAccess 中添加了以下权限：
<table>
	<tr>
	<th>权限</th><th>描述</th>
	</tr>
	<tr>
	<td><code>cls:logset</code></td><td>用于获取日志信息</td>
	</tr>
	<tr>
	<td><code>cls:topic</code></td><td>用于获取日志信息</td>
	</tr>
	<tr>
	<td><code>monitor:DescribeSortObjectList</code></td><td>用于获取函数监控信息</td>
	</tr>
</table>
- 预设策略 QcloudSCFFullAccess 当前权限如下：

``` json
{
   "version":"2.0",
   "statement":[
      {
         "action":[
            "scf:*",
            "tag:*",
            "cam:DescribeRoleList",
            "cam:GetRole",
            "cam:ListAttachedRolePolicies",
            "apigw:DescribeServicesStatus",
            "apigw:DescribeDomain",
            "cos:GetService",
            "cos:HeadObject",
            "cmqtopic:ListTopicDetail",
            "cmqqueue:ListQueueDetail",
            "ckafka:ListInstance",
            "vpc:DescribeVpcEx",
            "vpc:DescribeSubnetEx",
            "cls:listLogset",
            "cls:listTopic",
            "cls:logset",
            "cls:topic",
            "monitor:GetMonitorData",
            "monitor:DescribeBasicAlarmList",
            "monitor:DescribeSortObjectList"
         ],
         "resource":"*",
         "effect":"allow"
      }
   ]
}
```
- 在预设策略 QcloudSCFReadOnlyAccess 中添加了以下权限：
<table>
	<tr>
	<th>权限</th><th>描述</th>
	</tr>
	<tr>
	<td><code>monitor:GetMonitorData</code></td><td>用于获取函数监控信息</td>
	</tr>
	<tr>
	<td><code>monitor:DescribeBasicAlarmList</code></td><td>用于获取函数监控信息</td>
	</tr>
	<tr>
	<td><code>cam:GetRole</code></td><td>用于获取用户角色信息</td>
	</tr>
	<tr>
	<td><code>cam:ListAttachedRolePolicies</code></td><td>用于获取用户角色策略信息</td>
	</tr>
	<tr>
	<td><code>vpc:DescribeVpcEx</code></td><td>用于获取网络信息</td>
	</tr>
	<tr>
	<td><code>vpc:DescribeSubnetEx</code></td><td>用于获取网络信息</td>
	</tr>
	<tr>
	<td><code>apigw:DescribeDomain</code></td><td>用于获取网关信息 </td>
	</tr>
	<tr>
	<td><code>cls:logset</code></td><td>用于获取日志信息</td>
	</tr>
  <tr>
	<td><code>cls:topic</code></td><td>用于获取日志信息 </td>
	</tr>
</table>
- 预设策略 QcloudSCFReadOnlyAccess 当前权限如下：

``` json
{
   "version":"2.0",
   "statement":[
      {
         "action":[
            "scf:Get*",
            "scf:List*",
            "monitor:GetMonitorData",
            "monitor:DescribeBasicAlarmList",
            "name/cam:GetRole",
            "name/cam:ListAttachedRolePolicies",
            "vpc:DescribeVpcEx",
            "vpc:DescribeSubnetEx",
            "apigw:DescribeDomain",
            "cls:logset",
            "cls:topic"
         ],
         "resource":"*",
         "effect":"allow"
      }
   ]
}
```
- 预设策略 QcloudAccessForScfRole 当前权限如下：
``` json
{
    "version": "2.0",
    "statement": [
        {
            "action": [
                "cos:GetBucket*",
                "cos:HeadBucket",
                "cos:PutBucket*",
                "apigw:*",
                "cls:*",
                "cos:List*",
                "cos:Get*",
                "cos:Head*",
                "cos:OptionsObject",
                "cmqqueue:*",
                "cmqtopic:*"
            ],
            "resource": "*",
            "effect": "allow"
        }
    ]
}
```
预设策略 QcloudAccessForScfRole 具备以下功能：
 - 配置 COS 对象存储触发器时，向 Bucket 配置中写入触发配置信息。 
 - 读取 COS 对象存储 Bucket 中的触发器配置信息。 
 - 在使用 COS 对象存储更新代码时，从 Bucket 完成代码 zip 包的读取操作。 
 - 配置 API 网关触发器时，完成 API 网关的服务、API 创建以及服务发布等操作。 
