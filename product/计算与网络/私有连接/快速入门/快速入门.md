本文指导您如何快速创建私有连接服务，将您账号VPC中部署的云服务共享给同地域下您账号中的其他VPC访问。

## 背景信息

VPC是您独有的云上私有网络，不同VPC之间默认完全隔离。您可以通过私有连接（Private Link）服务，实现腾讯云VPC与其他VPC上安全稳定的访问连接，简化网络架构，避免公网访问服务带来的潜在安全风险。

使用Private Link建立连接，您需要创建终端节点服务和终端节点。在创建终端节点服务之前，您需要创建一个内网4层负载均衡实例，并创建监听器关联已经部署业务的云服务器实例，之后在创建终端节点服务时关联该负载均衡实例，此时终端节点服务将作为服务提供方的业务访问入口，供服务使用方创建的终端节点来申请连接，连接建立成功后，服务使用方即可访问服务提供方的部署业务服务。

## 场景示例

本文以下图业务场景为例。某公司业务分布在两个私有网络：VPC1和VPC2，因业务发展，公司在VPC2中部署了相关服务资源，且希望将VPC2中的业务共享给VPC1进行访问。为避免公网访问带来的潜在安全风险，使用腾讯云私有连接Private Link来实现VPC1 到VPC2 的安全内网访问方案。
![](https://main.qcloudimg.com/raw/2e3252331d564196240811a069cc48ff.png)

## 前提条件

+ 您已注册腾讯云账号，并已创建服务提供方VPC2和服务使用方VPC1。
+ 在服务提供方VPC2中已创建内网4层CLB实例，并在CLB后端云服务器实例中部署相关服务资源，请确保后端云服务器实例可以正常处理负载均衡转发的请求，具体请参加 [负载均衡快速入门](https://cloud.tencent.com/document/product/214/8975)。
+ 为保证服务使用方能够正常访问腾讯云公共业务，例如MySQL，**请确保服务提供方VPC2中负载均衡后端云服务器关联的安全组已放通11.163.0.0/16地址段**，如下图所示。   
	<img src="https://main.qcloudimg.com/raw/0462ab7efa311e9fb253e147628e2f7a.png" width="80%" />

## 操作步骤

### 步骤1：服务提供方创建终端节点服务

>?本例中服务提供方VPC2中已创建4层内网CLB，CLB后端云服务器实例已部署相关业务服务，且云服务器实例安全组已放通11.163.0.0/16网段。

1. 登录 [私有网络控制台](https://console.cloud.tencent.com/vpc/vpc?rid=16)。
2. 在左侧导航栏单击【私有连接】>【终端节点服务】。
3. 单击【新建】，在弹出的新建终端节点服务界面，配置相关参数。
    <img src="https://main.qcloudimg.com/raw/f71f06ee845d5c751ac206e927914e72.png" width="50%" />
   
	 参数说明如下：

 + 服务名称：自定义终端节点服务的名称。
 + 所在地域：终端服务节点所在地域。
 + 所属网络：选择所属VPC，本例选择VPC2。
 + 负载均衡：选择VPC下已创建的负载均衡，本例选择VPC2中已创建好的CLB实例。
 + 自动接受：指定终端节点服务是否自动接受终端节点发起的连接请求，默认为否，此处和白名单策略结合使用，遵循如下原则。
   + 如果是同账号，则默认自动加入白名单列表，而无论此处选择是或者否，系统都认为是自动接受，终端节点创建成功即为可用状态。
   + 如果是跨账号，选择【是】自动接受时，且终端节点在用户白名单中，终端节点创建成功即为可用状态。
   + 如果是跨账号，选择【否】不接受自动连接时，终端节点创建成功的初始状态为【待接受】，需等服务方接受后方可变更为可用。

4. 完成参数设置后，单击【确定】完成终端节点服务的创建。

### 步骤2：服务使用方创建终端节点

1. 单击左侧导航栏单击【终端节点】。

2. 单击【新建】，在弹出的新建终端节点界面，配置相关参数。
    <img src="https://main.qcloudimg.com/raw/4d19dc396e6dc272383f9d5a5d37e29a.png" width="50%" />

 参数说明如下：

    + 名称：自定义终端节点的名称。
    
    + 所属地域：终端节点所在地域。
    
    + 所属网络：选择终端节点所在的VPC，本例选择VPC1。
    
    + 所属子网：选择终端节点所在的子网。
    
    + IP地址：终端节点的IP地址。可以指定IP地址，IP地址为VPC1内的内网IP，也可以选择自动分配IP。
    
    + 对端账户类型：选择需要访问的VPC的所属账户，【我的账户】说明是同账户VPC的访问，【其他账户】说明是跨账户VPC的访问，本例选择【我的账户】。
    
      >?如果是跨账户，则需要将本账户的账号告知对端账户，且发起连接请求后，需要服务端接受后才可联通。
    
    + 选择服务：输入终端节点服务的ID后单击【验证】，只有验证通过的服务才可建立连接。
     <img src="https://main.qcloudimg.com/raw/073830696e0fad180b42c43155d0356a.png" width="50%" />
3. 完成参数配置后，单击【确定】。

### 步骤3：服务使用方发起访问请求进行连接验证

1. 登录服务使用方VPC1下的某台CVM，通过VIP+VPORT 访问服务提供方的后端服务。
2. 本例使用telnet验证连通性，执行telnet *VIP VPORT*。
     >?如果服务器没有安装telnet，请先执行 `yum install telnet` 安装telnet。
	
	获取终端节点VIP：
 <img src="https://main.qcloudimg.com/raw/e05b372a650e384513261bf66757d58c.png" width="70%" />

 获取CLB的VPORT：
 <img src="https://main.qcloudimg.com/raw/922dc796b2d687354a355ab6fe845437.png" width="70%" />

	如果出现如下信息，表示已连接：

<img src="https://main.qcloudimg.com/raw/546f1f75ba5fbb61bf80be0f8ead6363.png" width="50%" />
