## 功能概述
黑石七层负载均衡支持 HTTP 协议，实现功能具体如下：
- 提供内/外网七层 HTTP 负载均衡能力；
- 支持内/外网七层健康检查能力，检查 HTTP 业务是否正常，并剔除不正常后端服务器；
- 通过域名 +URL 路径方式实现前端请求向后端不同服务器转发；
- 通过 cookies 插入方式来实现内/外网七层 HTTP 会话保持；
- 改变目前后端服务器与 LB 粗粒度绑定，实现后端服务器与转发 URL 细粒度绑定，同时实现同一转发 URL 绑定不同后端服务器的不同后端端口。例如一个转发 URL，监听器和后端服务器如下： 
 - 监听器 portocal：HTTP，vport：80；
 - 后端服务器：RS1，rport：80；RS2，rport：81；RS3，rport：83；RS3，rport：85；
 
## 操作指南
### 新建七层 HTTP 监听器
1. 登录腾讯云官网，进入[黑石负载均衡实例列表页](https://console.cloud.tencent.com/lbbm/lb)，
2. 单击需要创建七层监听器的 LB，进入 LB 详细界面
3. 选择七层监听器，单击【新建】 ，弹出新建七层监听器界面。
![](https://main.qcloudimg.com/raw/0a631e95159674e6ec862817da86d6e8.png)
4. 端口协议选择HTTP，端口号默认为80，可以自行修改，当 LB 计费模式为 按固定带宽计费 时，需要填写带宽峰值。
![](https://main.qcloudimg.com/raw/d90e9bdaa7965d45746528bb2d8f8e48.png)

>!
- 此处填写的的端口号为前端对外提供服务端口；
- 当带宽峰值设置为0时，流量无法出外网；

### 监听器中添加转发域名和 URL 路径
七层监听器创建完成后就可以添加转发域名与 URL 路径。
- 基本配置，进行域名、URL 路径以及均衡方式设置，域名及 URL 路径设置规范请参照文档 [黑石负载均衡域名及 URL 配置规范](https://cloud.tencent.com/document/product/1027/33463)。
- 健康检查，进行检测间隔、健康阀值等参数设置，该功能可以帮助您自动检查并移除异常的服务器端口。
- 会话保持，是否开启以及保持时间设置。


### 在 URL 路径中绑定物理主机
域名与 URL 路径设置完成后，就可以进行后端 RS 服务器绑定，绑定资源支持黑石物理服务器、托管服务器与虚拟 IP。
1. 单击绑定在弹出框中选择需要绑定的资源。 
2. 对选中的服务器进行后端端口与权重设置，针对同一台物理主机绑定不同端口及权重。
