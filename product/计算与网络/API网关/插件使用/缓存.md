## 操作场景

通过配置缓存插件，API 网关可存储后端应答，当遇到相同请求参数的请求时，API 网关将直接返回缓存的应答，无需转发到后端服务，以此达到降低后端的负荷，增加平滑度的目的。

## 操作步骤

### 步骤1：创建插件

1. 登录 [API 网关控制台](https://console.cloud.tencent.com/apigateway)。
2. 在左侧导航栏，单击【插件—系统插件】，进入系统插件列表页。
3. 单击页面左上角的【新建】，选择插件类型为【缓存】，新建一个缓存插件。缓存插件的配置项如下：

| 参数          | 是否必填 | 说明                                                         |
| ------------- | -------- | ------------------------------------------------------------ |
| 缓存参数      | 必填     | 根据参数或参数的组合区分缓存内容，参数位置支持选择Header、Body、Query |
| 请求方法      | 必填     | 支持GET、POST、PUT、DELETE、HEAD方法，支持多选               |
| 缓存状态码    | 必填     | 仅缓存插件中填写的状态码的响应，其他状态码不缓存，多个状态码间用英文逗号隔开 |
| Cache-Control | 必填     | 通过Cache-Control请求头影响缓存策略，默认关闭                |
| 缓存时间      | 必填     | 缓存有效的时间，可填写(0,3600]之间的正整数                   |

![](https://qcloudimg.tencent-cloud.cn/raw/a56706c16714848626b78618a7b52bf4.png)

### 步骤2：绑定 API 并生效

1. 在列表中选中刚刚创建好的插件，点击操作列的【绑定API】。
2. 在绑定 API 弹窗中选择服务和环境，并选择需要绑定插件的 API。
   ![](https://main.qcloudimg.com/raw/d7fd3c3539d6f623f45ebfdf0674d97e.png)
3. 单击【确定】，即可将插件绑定到 API，此时插件的配置已经对 API 生效。


## 注意事项

- 一个缓存插件中最多配置10个参数；
- API 网关做参数校验和命中缓存时，都是大小写不敏感的；
- 对于共享实例来讲，每个用户每个Region的缓存容量总限制为5M；专享实例的缓存容量根据实例规格不同而不同，但远大于共享实例；
- 缓存插件作用在响应过程中，优先级一般低于作用在请求过程中的插件；但缓存插件优先级高于自定义响应体插件，如果触发缓存插件，自定义响应体修改的是用户缓存的响应体；
- 当开启`Cache-Control`配置时，网关将遵守请求/响应头中的Cache-Control头的约定来处理缓存。在这种情况下，如果网关获取不到Cache-Control头，则默认进行缓存，并使用插件中配置的“缓存时间”字段作为缓存超期时间。
