本文将介绍如何从零开始，购买容器镜像服务企业版实例，配置网络访问策略，最终实现容器镜像的推送及拉取。  
若您需要使用容器镜像服务个人版，请参考：[镜像仓库基本教程](https://cloud.tencent.com/document/product/457/9117)

## 步骤1：注册腾讯云账号
如果您已在腾讯云注册，可忽略此步骤。  
**点此注册腾讯云账号**

## 步骤2：购买企业版实例
> 
> 如果您尚未获得容器镜像服务企业版内测资格，请 [申请使用](https://cloud.tencent.com/apply/p/8mvsqz6j8e3)。  
> 
登录容器镜像服务[控制台](https://console.cloud.tencent.com/tcr)，进入“实例列表”页面，点击新建，即可开始配置您独享的企业级实例。

![](https://main.qcloudimg.com/raw/193d7b588070d06456d53adb2e928b27.png)
- **实例名**：输入实例名称，该名称全局唯一，请避免与自己或他人现有实例名称重复；该名称将直接用于该实例 Registry 服务的访问域名，创建后不可修改，请谨慎选择，建议组合使用公司，实例所在地域或项目的缩写。
- **实例地域**：选择您希望部署该实例的地域，实例创建后地域将无法更改，请尽量选择与您主要业务所在的相同地域。
- **实例规格**：选择您希望购买的实例规格，不同实例规格具有不同的实例性能及配额。免费内测阶段暂时支持购买“标准版”实例。
- **实例域名**：自动生成的实例访问域名，前缀与实例名一致，使用 docker login 登录实例时即使用该域名。创建后无法修改。

完成以上配置并点击确定，即开始创建企业版实例，您可在“实例列表”内查看该实例的创建进度，预计 1min 内即可创建完成。待实例状态转变为“运行中”后，即表明该实例已经创建完成并在正常运行，接下来，您可以配置实例的访问控制策略，并登录实例。

## 步骤3：配置网络访问策略
> 
> 注意：为保护您的数据安全，实例创建后默认拒绝全部公网及内网访问，新建实例后请首先完成网络访问策略配置。
> 
进入“访问控制”页面，在页面上方的实例列表内选择方才创建的实例，即可开始配置该实例的公网及内网的访问策略。  
#### 公网访问：
在“公网访问”页面点击右上角“开启公网访问入口”即可开启实例的公网访问入口，允许Docker客户端通过公网访问实例。入口开启完成后，点击“添加公网白名单”即可配置需要放通的公网IP地址段。请注意，为保障您的实例安全，不支持配置“0.0.0.0/0”放通全部IP地址端。

![](https://main.qcloudimg.com/raw/c6688eac2a0e278a25f52d5f78ebdf91.png)

#### 内网访问：
在“内网访问“页面点击”新建“，即可开始将已有的私有网络(VPC)接入至实例，实现VPC内集群通过内网访问实例。
其中，请选择您集群所在的VPC，并选择该VPC下的一个子网。请注意，新建内网访问链路将占用该子网下的一个IP地址。


![](https://main.qcloudimg.com/raw/e9e6891b58255bcec732053c24037fc6.png)

## 步骤4：创建镜像仓库
在”命名空间“页面选择本实例，并点击”新建“以创建新的命名空间。命名空间用于管理实例内的镜像仓库，不直接存储容器镜像，可映射为企业内团队，项目或是其他自定义层级。
![](https://main.qcloudimg.com/raw/3fa257ea95bafea574ef928c102f711f.png)
完成命名空间创建后，点击”镜像仓库“进入镜像仓库管理页面。点击”新建“并选择已创建的命名空间，配置完成其他参数后即可新建仓库。
![](https://main.qcloudimg.com/raw/df876be6259281a58e4d46ff299bf264.png)

## 步骤4：推送拉取镜像
通过以上流程，您已经创建了实例及镜像仓库，本步骤将实现向镜像仓库内推送镜像，并进而拉取镜像。此步骤需要您使用一台安装有Docker的云服务器或物理机，并确保该访问客户端在您在步骤3中定义的公网或内网允许访问范围内。  
#### 登录Registry实例
在实例列表页内点击刚刚新建的实例，进入实例管理页面后选择”访问凭证“，即可查看登录实例的用户名，点击”重新生成“可获得临时登录密码。
在命令行工具中执行以下指令，其中访问域名可根据您刚才新建的实际实例名称而进行修改，并按照系统提示输入用户名及临时密码。
```
docker login demo-tcr.tencentcloudcr.com
```
命令行工具显示 ”Login Succeeded“ 即表示登录成功。
#### 推送容器镜像
您可在本地构建新的容器镜像或从DockerHub上获取一个公开镜像用于测试，以DockerHub官方的nginx最新镜像为例，在命令行工具中执行以下指令即可推送该镜像。
```
docker tag nginx:latest demo-tcr.tencentcloudcr.com/team-01/demo-repo:latest
docker push demo-tcr.tencentcloudcr.com/team-01/demo-repo:latest
```
#### 拉取容器镜像
以刚刚推送的镜像为例，在命令行中执行以下指令即可拉取该镜像。
```
docker pull demo-tcr.tencentcloudcr.com/team-01/demo-repo:latest
```
## 出现问题？
非常抱歉您在使用时出现问题，您可以第一时间通过 [提交工单](https://console.cloud.tencent.com/workorder/category) 联系我们，也可以先参考相关文档，如 [常见问题](https://cloud.tencent.com/document/product/1141/39292) 进行问题定位和解决。