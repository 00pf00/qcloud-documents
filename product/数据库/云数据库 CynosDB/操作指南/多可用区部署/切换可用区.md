TDSQL-C for MySQL 支持更换主可用区和备可用区，并可通过设置选择手动切或自动切换，您可以通过该功能实现将数据库集群计算节点迁移到其他可用区。
## 使用场景和注意事项
切换集群主备可用区的功能适用于灾难恢复、设备故障等场景。
![](https://qcloudimg.tencent-cloud.cn/raw/dc53b3292eb2e84eee7e665885a9097e.png)

- 主备可用区切换过程中，会出现2-5秒左右的连接闪断。建议您在业务低谷期执行切换操作并确保应用具备重连机制。
- 如果目标可用区是备可用区，则不需要迁移数据。系统只需要切换数据库计算节点，因此可以达到比较快的跨机房切换效果，该操作常用于容灾演练。
- 集群整体发生切换，即包括读写节点、只读节点均发生切换（不支持仅部分节点切换）。
- 切换后读写地址、只读地址均不发生改变。

## 操作步骤
### 自动切换说明
本功能支持在发生可用区故障情况下，集群主备可用区可自动进行切换，以确保您的业务能正常运行，保护数据库。
### 手动切换设置
如您因业务需要对集群主备可用区立即切换或指定时间切换，可进行手动切换可用区设置。
1. 登录 [TDSQL-C for MySQL控制台](https://console.cloud.tencent.com/cynosdb)。
2. 在集群列表，找到需设置此功能的集群，单击**集群 ID/集群名**或操作列的**管理**进入集群管理页。
3. 在**集群详情**>**可用性信息**后单击**可用区切换**。
![](https://qcloudimg.tencent-cloud.cn/raw/475e1b4fef877fe02d7e36db6f6aa332.png)
4. 在可用区切换窗口，单击**立即切换**或**维护时间内切换**。
![](https://qcloudimg.tencent-cloud.cn/raw/84f5bfac1dd236ab8b1dfa56441a1d72.png)
>?
>- 可用区切换时，会有秒级别的连接闪断，请确保业务具备重连机制。
>- 通过**集群管理页**>**实例列表**，单击对应**实例ID/实例名**，进入实例详情，在**维护信息**后单击编辑可设置修改维护的时间。

5. 勾选 “可用区切换时，会有秒级别的连接闪断，请确保业务具备重连机制”，单击**确定**，待集群状态为**运行中**时，可在**集群详情页**可用性信息处查看切换的可用区。
![](https://qcloudimg.tencent-cloud.cn/raw/bda8fda1c189f6bf4e42a73cfb518761.png)

## 常见问题
- Q：需要多长时间才能完成可用区的切换？
A：若您选择的目标可用区是备可用区，则更换主可用区时不需要迁移数据。系统只需要切换数据库计算节点，因此可以达到比较快的跨机房切换效果。
- Q：集群整体发生切换后读写地址是否变更？
A：集群整体发生切换时，读写节点、只读节点均发生切换，切换后读写地址、只读地址均不发生改变。
- Q：手动切换/自动切换后，如果对实例进行升级、升配等操作，是否会影响或者重置主备可用区信息？
A：切换后不会影响和重置主备可用区信息。