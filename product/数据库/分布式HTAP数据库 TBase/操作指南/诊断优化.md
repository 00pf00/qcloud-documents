TDSQL PostgreSQL提供诊断优化的功能，可以在控制台查询相关信息并下载。
## 功能说明

#### 实时会话


- 展示当前所有CN上的session列表。
- 自动刷新频率：5分钟，用户点击了‘立即刷新’将立即刷新一次。
- 查询文本中点击‘查看详情’，将展示SQL详情，并支持复制。
- 支持当前列表的下载

#### 锁分析

- 可以通过条件搜索的方式展示该实例的所有CN上查到的实时锁信息。
- 可以支持pid和查询文本的模糊查询，pid针对被阻塞pid和阻塞pid字段，查询文本针对被阻塞查询文本和阻塞查询文本字段。
- 如果用户没有输入搜索条件将不展示当前系统的锁。
- 支持当前列表的下载。

## 注意事项

- 实时会话只能支持批量kill 20个session，选择超出20，前台置灰并且在按钮上展示提示。
- pid支持多值搜索，限制20个pid。
- 文本只支持单值搜索，文本大小限制3kb。

## 操作步骤

1. 登录[TDSQL PostgreSQL 控制台](https://console.cloud.tencent.com/tbase)，在实例列表，单击实例 ID 或**操作**列的**管理**，进入实例管理页面。

2. 在实例管理页面，选择**诊断优化**页。

   - 可根据表格全名，起止时间，运行时长超过秒数，查询实时会话。
   - 会话信息包括后端Pid，状态，运行时长，所属CN，会话ID等。
   - kill阻塞会话ID。
   - 通过**下载**按钮，下载当前列表。

![](https://qcloudimg.tencent-cloud.cn/raw/4944b93d7cf032994a8a001dd9d046e1.png)

   - 可根据关键字查询锁。
   - 锁信息包括被阻塞pid，阻塞pid，阻塞会话ID等。
   - cancel或terminate阻塞会话ID。
   - 通过**下载**按钮，下载当前列表。

![](https://qcloudimg.tencent-cloud.cn/raw/e914e688f9006cca513acbe86d16c1b9.png)
