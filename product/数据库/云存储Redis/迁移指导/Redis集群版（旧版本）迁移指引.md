### 背景：

云数据库Redis集群版旧版本（2018年1月1日之前购买的集群版为旧集群版）由于版本较低、架构老旧，存在一定的稳定性风险，为了保证业务最大的稳定性，我们建议您近期尽快迁移到全新的Redis 4.0集群版。
升级到新版本将能够体验更灵活的规格配置，更高的性能以及更完善的功能，腾讯云Redis 4.0集群版产品介绍：https://cloud.tencent.com/document/product/239/18336
，我们将从2018年10月15日到2018年12月5日协助您将redis老集群版实例升级至redis主从版或新集群版。腾讯云需要您的协助完成本次迁移相关工作，请在收到该信息后及时联系我们。非常感谢您的理解和配合！
> 说明: Redis集群版（旧版本）实例无法热迁移到主从版或者集群版， 如果要保证迁移过程不丢失数据，从迁移开始时，需要停止对集群版CRS的写入。

### 迁移步骤：

#### 资源准备：
- 购买新的主从版或者集群版实例，如果数据量小于16GB，并且后续数据增长不会超过60GB，QPS不会超过5万，建议使用Redis 2.8主从版，否则建议购买Redis 4.0集群版，Redis 4.0集群版完全兼容Redis集群版（旧版本）；
- Redis 2.8主从版刊例价76元/GB/月，Redis 4.0集群版刊例价 84元/GB/月，这里可以根据实际情况选择；Redis 2.8主从版的产品文档：https://cloud.tencent.com/document/product/239/17950
- 准备一台CVM供数据导入使用，CVM的磁盘的空间需要能够存储现有实例的数据；
- 下载数据导入工具crs-port，工具使用说明和下载地址：https://cloud.tencent.com/document/product/239/611

#### 正式迁移：
- 业务停止业务写入Redis集群版（旧版本）实例；
- 创建Redis集群版（旧版本）实例的备份数据，等待实例完成备份，备份时长根据数据多少而定，这里会生产一个RDB文件；
![](https://main.qcloudimg.com/raw/2d29f78389af14977806c2af399c5463.png)
- 数据备份完成后，能在备份列表中看到之前备份的文件，复制内网下载地址，从内网CVM下载备份文件，注意不支持跨可用区下载；
![](https://main.qcloudimg.com/raw/266711e37f7b4f195aaa724d446a06b7.png)
- 初始化新购的Redis 2.8主从版，或者Redis 4.0集群版的密码，然后使用crs-port工具将下载的RDB文件导入到新的实例；
	Crs-port使用说明：
crs-port restore -n 16 -i /data/dump.rdb -t 192.168.0.1:6379 -A passwd
- 数据导入完成后，通过控制台确认数据导入成功，可以查看实际的内存使用量：
![](https://main.qcloudimg.com/raw/417f9d6d6fc9efe7224675ac16351398.png)
- 迁移应用到新的实例，这里只需要将代码中的旧集群版的IP更新为新实例的ID即可。
