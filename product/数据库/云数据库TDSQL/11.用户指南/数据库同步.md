## 操作场景
数据库同步功能支持将多个云数据库 MariaDB 或分布式数据库 TDSQL 同步到目标数据库，可以实现在不停止数据库实例的情况下，完成数据库的同步工作。

**使用范围**

| 源实例类型            | 目标实例类型             |
| --------------------- | ------------------------ |
| 云数据库 MariaDB | 云数据库 MariaDB    |
|                       | 云数据库 postgreSQL |
|                       | 消息队列 Ckafka           |
| 分布式数据库 TDSQL     | 消息队列 Ckafka           |

>?一个同步任务只能选择一个 topic，否则导致出错。

## 操作步骤
1. 登陆云数据库MariaDB数据库同步控制台（https://console.cloud.tencent.com/tdsql/synctask）
2. 数据库同步控制台界面的功能选择中，选择创建同步任务，进去创建同步任务界面 
3. 输入任务名称、设置源实例信息和目标实例信息，单击下一步。
>?目标实例类型为消息队列Ckafka时，需创建服务预设角色并授权数据传输相关权限 
4. 选择表明匹配模式：
-精确匹配：系统将以默认精确匹配方式在源、目的库中匹配表名。
-正在匹配：系统将以默认正则方式在源、目的库中匹配表名"完全相同"的表。
输入匹配库：`dbname`.`tablename`。、
5. 设置确认，下一步。 
6. 同步任务效验，全部通过后可保存并启动数据库同步任务，否则需要返回修改数据库同步任务。 
7. 数据库同步任务可在控制台查看进程。
 
## 注意事项
•	为保证目标表中记录不重复，建议您对源表和目标表加上主键。
•	主键存在时将会依赖主键进行更新，主键不存在时不依赖主键，此时表结构不一致时将会失败（表结构一致意味着表的列名，列类型，列顺序完全一致）。
•	如果源表和目标表有相同的行记录（无论是否有主键），将会以源表数据优先覆盖目标表数据。
•	同步遇到错误时，同步进程将自动重试直到成功（后台不提供DEBUG信息）。
•	目标表有额外记录时，将会以追加的形式同步数据到目标表。
•	请保持目标数据库表结构与来源数据库表结构一致（字段被修改、删除可能会导致同步错误）。
•	源表使用DDL语句，包括ALTER,CREATE TABLE,DROP,RENAME五种将同步到目标库；
•	使用pt-online-schema-change修改源表结构时，将会同步DML到目标表（如果是多个实例同步到一个实例，将可能导致数据丢失，详见FAQ）。
•	同步进程将不会开启排它锁（写锁），您可以对目标库进行写操作。
•	如果是分布式数据库TDSQL订阅到Ckafka中时，由于存在分表、广播表时；正则匹配可能匹配到多相同张表，这是正常现象，因为同步工具会分别解析每个分片。





