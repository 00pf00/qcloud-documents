## 概述

最小权限原则指的是：当您在授权的时候，请务必明确权限范围——需要明确授予**指定用户**在**何种条件**下，执行**何种操作**，访问**何种资源**的权限。

在使用COS的时候，您可能需要为您的子用户或者协作者授予相应的用户策略，允许他们协助您操作COS上的资源；或者需要为存储桶添加相应的存储桶策略，允许指定的用户能够在您的存储桶中进行指定的操作，操作指定的资源。

在最小权限原则下，您需要在策略中明确指定以下信息：

- 委托人（principal）：必须明确指定您需要授予哪些子用户（需要填写用户ID）、协作者（需要填写用户ID）、匿名用户或者用户组权限；
- 语句（statement）：在以下几项参数中明确填写相应的参数

--  效力（effect）：必须明确声明该策略是“允许”还是“显式拒绝”，包括 allow 和 deny 两种情况。
--  操作（action）：必须明确声明该策略允许或拒绝的操作。操作可以是 API（以 name 前缀描述）或者功能集（一组特定的 API，以 permid 前缀描述）。
--  资源（resource）：必须明确声明该策略授权的具体资源。资源是用六段式描述。您可以指定资源范围为指定的文件，如`exampleobject.jpg`，或者指定的目录，如`examplePrefix/*`。除非业务需要，否则请不要随意授予访问所有资源的权限，即通配符`*`。
--  条件（condition）：描述策略生效的约束条件。条件包括操作符、操作键和操作值组成。条件值可包括时间、IP 地址等信息。

> 注意：当您在授权的时候，请尽量避免授予子用户、协作者或者其他指定用户访问所有资源或者进行所有操作的权限；如果您授予了全部操作和全部资源的操作权限，则存在由于权限范围过大导致数据泄露的风险。

## 用户策略最小权限指引

用户策略是指在[CAM控制台](https://console.cloud.tencent.com/cam/policy)添加的用户权限策略，用于授予用户访问 COS 资源的权限。用户访问策略概述的配置说明可详见文档[访问策略语言概述](https://cloud.tencent.com/document/product/436/18023)。

### 授权示例

#### 授予账户访问某个对象的权限

假设需要授予账户 UIN `100000000001`，下载存储桶`examplebucket-1250000000`中对象`exampleObject`的权限，则相应的访问策略为：

```
{
   "version": "2.0",
   "principal": {
      "qcs": [
         "qcs::cam::uin/100000000001:uin/100000000001"
      ]
   },
    "statement": [
        {
            "action": [
                "name/cos:GetObject"
            ],
            "effect": "allow",
            "resource": [
                "qcs::cos:ap-guangzhou:uid/1250000000:examplebucket-1250000000.ap-guangzhou.myqcloud.com/exampleObject"
            ]
        }
    ]
}
```

#### 授予子账户访问某个目录的权限

假设需要授予子账户 UIN `100000000011`（主账户 UIN 为 `100000000001`），下载存储桶`examplebucket-1250000000`中目录为`examplePrefix`下的对象的权限，则相应的访问策略为：

```
{
   "version": "2.0",
   "principal": {
      "qcs": [
         "qcs::cam::uin/100000000001:uin/100000000011"
      ]
   },
    "statement": [
        {
            "action": [
                "name/cos:GetObject"
            ],
            "effect": "allow",
            "resource": [
                "qcs::cos:ap-guangzhou:uid/1250000000:examplebucket-1250000000.ap-guangzhou.myqcloud.com/examplePrefix/*"
            ]
        }
    ]
}
```

## 存储桶策略最小权限指引

存储桶策略是指在存储桶中配置的访问策略，允许指定用户对存储桶及桶内的资源进行指定的操作。配置存储桶策略可参考文档[添加存储桶策略](https://cloud.tencent.com/document/product/436/33369)。

### 授权示例

#### 授予子账号访问特定对象的权限

假设需要授予子账户 UIN `100000000011`（主账户 UIN 为 `100000000001`），下载存储桶`examplebucket-1250000000`中的对象`exampleObject.txt`和目录`examplePrefix`下所有对象的权限，则相应的访问策略为：

```
{
  "Statement": [
    {
      "Action": [
        "name/cos:GetObject"
      ],
      "Effect": "allow",
      "Principal": {
        "qcs": [
          "qcs::cam::uin/100000000001:uin/100000000011"
        ]
      },
      "Resource": [
        "qcs::cos:ap-beijing:uid/1250000000:examplebucket-1250000000/exampleObject.txt",
        "qcs::cos:ap-beijing:uid/1250000000:examplebucket-1250000000/examplePrefix/*"
      ]
    }
  ],
  "version": "2.0"
}
```
