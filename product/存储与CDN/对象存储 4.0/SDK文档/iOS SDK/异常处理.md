当 SDK 请求失败的时候，返回的 error 将不为空，并且包括了错误码、错误描述和其它一些调试必备的信息，以帮助开发者快速解决问题。
返回错误码（封装在返回的 error 里）主要包括三类：设备本身因为网络原因等返回的错误码，SDK 网络层本地客户端自定义错误、以及 服务端错误

- ## 设备本身因为网络原因等返回的错误码
对于设备本身因为网络原因产生的错误码，都是负数并且是四位数，例如-1001，这类错误码由苹果公司定义，可以参考 Foundation 框架中的 NSURLError.h 头文件内的定义，或者是 [苹果官方文档说明](https://developer.apple.com/documentation/foundation/1508628-url_loading_system_error_codes)。
- ## SDK 网络层本地客户端自定义错误
对于腾讯云 SDK 网络层本地客户端自定义错误：主要是指网络异常、证书无效、参数校验失败等，如下表所示：

|错误码|错误信息|错误描述|
| ---- | ---- | ---- |
|10000| InvalidArgument| 参数错误|
|10001| InvalidCredentials|  证书无效|
|10004| UnsupportOperation| 无法支持的操作|
|20001| InvalidArgument| 服务器返回了不合法的数据|
|20004| PoorNetwork| 数据完整性校验失败|
|30000|  UserCancelled| 用户取消|
|30002| AlreadyFinished| 任务已完成|

- ## 服务端错误

对于 COS 返回的错误码，是基于 HTTP 的状态码而来的，也就是404，503这类。对于这类错误码，可以参考 [错误码](https://cloud.tencent.com/document/product/436/7730) 文档寻求解决方案，也可以通过 request_id使用自主诊断工具快速定位问题

#### 获取 request_id 示例


### 通过 iOS SDK 获取

```
QCloudCOSXMLUploadObjectRequest* put = [QCloudCOSXMLUploadObjectRequest new];
/** 本地文件路径，请确保 URL 是以 file:// 开头，格式如下 ：
1. [NSURL URLWithString:@"file:////var/mobile/Containers/Data/Application/DBPF7490-D5U8-4ABF-A0AF-CC49D6A60AEB/Documents/exampleobject"]
2. [NSURL fileURLWithPath:@"/var/mobile/Containers/Data/Application/DBPF7490-D5U8-4ABF-A0AF-CC49D6A60AEB/Documents/exampleobject"]
*/
NSURL* url = [NSURL fileURLWithPath:@"文件的URL"];
// 存储桶名称，由BucketName-Appid 组成，可以在COS控制台查看 https://console.cloud.tencent.com/cos5/bucket
put.bucket = @"examplebucket-1250000000";
// 对象键，是对象在 COS 上的完整路径，如果带目录的话，格式为 "video/xxx/movie.mp4"
put.object = @"exampleobject";
// 需要上传的对象内容。可以传入NSData*或者NSURL*类型的变量
put.body =  url;
// 监听上传进度
[put setSendProcessBlock:^(int64_t bytesSent,
                           int64_t totalBytesSent,
                           int64_t totalBytesExpectedToSend) {
    //      bytesSent                 本次要发送的字节数（一个大文件可能要分多次发送）
    //      totalBytesSent            已发送的字节数
    //      totalBytesExpectedToSend  本次上传要发送的总字节数（即一个文件大小）
}];
// 监听上传结果
[put setFinishBlock:^(QCloudUploadObjectResult *result, NSError *error) {
    // 获取requestid
   [result.__originHTTPURLResponse__.allHeaderFields objectForKey:@"x-cos-request-id"]
}];
[put setInitMultipleUploadFinishBlock:^(QCloudInitiateMultipartUploadResult *
                                        multipleUploadInitResult,
                                        QCloudCOSXMLUploadObjectResumeData resumeData) {
    // 在初始化分块上传完成以后会回调该 block，在这里可以获取 resumeData，uploadid
    NSString* uploadId = multipleUploadInitResult.uploadId;
}];
[[QCloudCOSTransferMangerService defaultCOSTransferManager] UploadObject:put];
```


## 使用自助诊断工具

针对请求可能遇到不同的报错情况，我们为您提供了 [COS 自助诊断工具](https://console.cloud.tencent.com/cos5/diagnose)，帮助您快速定位问题，调试报错代码。

#### 使用步骤
1. 复制异常处理返回的 RequestId。
2. 单击 [COS 自助诊断工具](https://console.cloud.tencent.com/cos5/diagnose)，进入自助诊断页面。
<div class="rno-api-explorer">
    <div class="rno-api-explorer-inner">
        <div class="rno-api-explorer-hd">
            <div class="rno-api-explorer-title">
                COS 自助诊断工具
            </div>
            <a href="https://console.cloud.tencent.com/cos5/diagnose" class="rno-api-explorer-btn" hotrep="doc.api.explorerbtn" target="_blank"><i class="rno-icon-explorer"></i>点击自助诊断</a>
        </div>
        <div class="rno-api-explorer-body">
            <div class="rno-api-explorer-cont">
                输入 RequestId 进行智能诊断，获取请求基本信息、帮助指引和诊断提示，快速定位请求错误。
            </div>
        </div>
    </div>
</div>
3. 在顶部的 RequestId 输入框中，输入待诊断的 RequestId，并单击**开始诊断**。
4. 稍侯片刻，便能看到相应的智能诊断结果。

