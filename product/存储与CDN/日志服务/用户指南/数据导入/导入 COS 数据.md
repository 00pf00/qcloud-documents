## 概述

日志服务（Cloud Log Service，CLS）投递功能打通产品生态上游链路，将腾讯云对象存储（Cloud Object Storage，COS）中的数据导入到日志服务，实现日志数据的查询分析、加工等操作，挖掘日志数据价值。您只需要在日志服务控制台进行简单的配置即可完成数据导入。

## 前提条件

- 开通日志服务，创建日志集与日志主题，并成功采集到日志数据。
- 开通对象存储，并确保待导入的文件已经上传到 COS Bucket 中，更多信息请参考 [上传对象](https://cloud.tencent.com/document/product/436/13321)。
- 设置当前操作账号拥有访问 COS 的权限，即已授权日志服务使用 CLS_QcsRole 角色访问您的 COS 资源。
 

## 配置流程

1. **选择日志主题**：可以选择现有的日志主题（topic）或者创建新的日志主题（topic），用于存储从 COS 导入到  CLS 的数据。
2. **导入数据源配置**：需要配置想要导入的 COS 对象路径，以及压缩方式（gzip/lzop/snappy/无压缩）。
3. **解析配置**：需要配置导入文件的解析格式，目前支持单行全文/JSON/CSV。
4. **索引配置**：需要配置目前 topic 的索引配置，且检索必须开启索引配置。如果选择已存在的日志主题，则新索引配置只对修改后的数据生效。

## 操作步骤

1. 登录 [日志服务控制台](https://console.cloud.tencent.com/cls)。
2. 在左侧导航栏中，单击**日志主题**，选择您需要投递的日志主题，进入日志主题管理页面。
>? 您也可以在左侧导航栏中，单击**概览**，选择其他日志下的**对象存储COS数据导入**，来新建一个日志主题用于存储从 COS 导入到 CLS 的数据。
>
3. 选择**采集配置**页签，在**数据导入配置**栏下单击**新增**。
![](https://qcloudimg.tencent-cloud.cn/raw/03107171eb18ad54dde7ee6335310b40.png)
4. 在创建采集配置页面，依次配置如下信息：
<table>
	<tr><th>配置项</th><th>说明</th><th>规则</th><th>是否必填</th></tr>
	<tr><td>任务名称</td><td>配置导入任务的名称。</td><td>字母、数字、_和-</td><td>是</td></tr>
	<tr><td>存储桶地域</td><td>配置需要导入的文件所在存储桶的地域位置。如果文件所在地域和导入日志主题所在地域不同，则会因跨地域访问而产生外网费用。</td><td>列表选择</td><td>是</td></tr>
	<tr><td>Bucket</td><td>选择需要导入的文件所在存储桶。下拉框会列出当前选择地域下的所有存储桶供您选择。</td><td>列表选择</td><td>是</td></tr>
	<tr><td>文件前缀</td><td>输入待导入的 OSS 文件所在文件夹的前缀，用于准确定位待导入的文件夹，支持输入文件前缀 csv/，或完整文件路径 csv/object.gz。</td><td>输入框</td><td>是</td></tr>
	<tr><td>压缩模式</td><td>选择待导入的 OSS 文件的压缩格式，日志服务根据对应格式进行解压并读取数据，支持 gzip/lzop/snappy/ 无压缩。</td><td>列表选择</td><td>是</td></tr>
</table>
5. 单击**预览**，系统会选择符合配置规则的一条路径数据进行展示，并提示输入的文件前缀下共有多少文件。如下图所示：
 ![](https://qcloudimg.tencent-cloud.cn/raw/cbcf6e04c9f9e356e8eaac650f6fe5ac.png)
6. 确认预览无误后，可单击**下一步**，进入解析配置。
