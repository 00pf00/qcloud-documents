## 产品概述

腾讯云视立方 iOS 超级播放器是腾讯云开源的一款播放器组件，简单几行代码即可拥有类似腾讯视频强大的播放功能，包括横竖屏切换、清晰度选择、手势和小窗等基础功能，还支持视频缓存，软硬解切换和倍速播放等特殊功能，相比系统播放器，支持格式更多，兼容性更好，功能更强大，同时还具备首屏秒开、低延迟的优点，以及视频缩略图等高级能力。

如您发现超级播放器组件满足不了您的业务的个性化需求，您可以集成 [视立方播放器 SDK](https://cloud.tencent.com/document/product/881/20216)，自己开发播放器界面和播放功能。这个需要您对播放器有一定的开发经验，接入成本相对会高些。


## 项目地址

腾讯云视立方 iOS 超级播放器的项目地址是 [SuperPlayer_iOS](https://github.com/tencentyun/SuperPlayer_iOS)。

## 阅读对象

本文档部分内容为腾讯云专属能力，使用前请开通 [腾讯云](https://cloud.tencent.com) 相关服务，未注册用户可注册账号 [免费试用](https://cloud.tencent.com/login)。

## 快速体验

腾讯云视立方 iOS 超级播放器已经开源，您可以下载项目 [SuperPlayer_iOS](https://github.com/tencentyun/SuperPlayer_iOS) 到本地，然后运行Demo，快速体验播放效果。

### 项目工程下载

#### 下载播放器组件 ZIP 包

您可以直接下载播放器组件 ZIP包，单击页面的**Code**>**Download ZIP**下载。
![](https://qcloudimg.tencent-cloud.cn/raw/7350c6a55fc99766d134a56fa2a55810.png)

#### 通过 Git 命令下载

1. 首先确认您的电脑上安装了 Git，若未安装，可参见 [Git 安装教程](https://git-scm.com/downloads) 进行安装。
2. 执行下面的命令把超级播放器组件工程代码 clone 到本地。
   ```shell
   git clone git@github.com:tencentyun/SuperPlayer_iOS.git
   ```
   提示下面的信息表示成功 clone 工程代码到本地。
   ```shell
   正克隆到 'SuperPlayer_iOS'...
   remote: Enumerating objects: 2637, done.
   remote: Counting objects: 100% (644/644), done.
   remote: Compressing objects: 100% (333/333), done.
   remote: Total 2637 (delta 227), reused 524 (delta 170), pack-reused 1993
   接收对象中: 100% (2637/2637), 571.20 MiB | 3.94 MiB/s, 完成.
   处理 delta 中: 100% (1019/1019), 完成.
   ```

### Demo 运行体验

1. 下载 xcode，如果已经下载可跳过此步骤，您可以进入 App Store 下载安装。
2. 下载Cocoapods，如果已经下载可跳过此步骤，您可以进入 [cocoapods官网](https://cocoapods.org/) 按照指引进行安装。
3. 下载工程，工程源码解压后的目录如下：

| 文件名          | 作用                        |
| --------------- | --------------------------- |
| SDK             | 存放播放器的 framework 静态库 |
| Demo            | 存放超级播放器 Demo          |
| App             | 程序入口界面                |
| SuperPlayerDemo | 超级播放器 Demo             |
| SuperPlayerKit  | 超级播放器组件              |

4. 在Demo目录，执行命令行 pod update，重新生成 TXLiteAVDemo.xcworkspace 文件。
5. 双击打开工程，修改证书选择真机运行。
6. 成功运行 Demo 后如下图，进入**播放器** >**超级播放器**，可体验播放器功能。
![](https://qcloudimg.tencent-cloud.cn/raw/7350c6a55fc99766d134a56fa2a55810.png)

## 集成指引[](id:guide)
您可以选择使用 Cocoapods 方式集成，或者手动下载 SDK 再将其导入到您当前的工程项目中。
### 方法一：Cocoapods
1. 本项目支持 cocoapods 安装，只需要将如下代码添加到 Podfile 中：
   ```xml
   pod 'SuperPlayer'
   ```
2. 执行 `pod install` 或 `pod update`。

### 方法二：手动下载

1. 下载 SDK + Demo 开发包，项目地址为 [iOS](https://github.com/tencentyun/SuperPlayer_iOS)。
2. 导入`TXLiteAVSDK_Player.framework`到工程中，并勾选`Do Not Embed`。

## 使用播放功能

### 使用播放器[](id:usePlayer)

播放器主类为`SuperPlayerView`，创建后即可播放视频，支持集成 fileId 或者 url 进行播放：

```xml
// 引入头文件
#import <SuperPlayer/SuperPlayer.h>

// 创建播放器  
_playerView = [[SuperPlayerView alloc] init];
// 设置代理，用于接受事件
_playerView.delegate = self;
// 设置父 View，_playerView 会被自动添加到 holderView 下面
_playerView.fatherView = self.holderView;
```

#### 集成fileId播放

```java
SuperPlayerModel *model = [[SuperPlayerModel alloc] init];
model.appId = 1400329073;// 配置 AppId
model.videoId = [[SuperPlayerVideoId alloc] init];
model.videoId.fileId = @"5285890799710670616"; // 配置 FileId
[_playerView playWithModel:model];
```

#### 集成url播放

```java
SuperPlayerModel *model = [[SuperPlayerModel alloc] init];
model.videoURL = @"http://your_video_url.mp4";   // 配置您的播放视频url
[_playerView playWithModel:model];
```

#### 私有加密播放

视频加密属于长视频场景下的一个细分场景。是视频平台自有的独播剧、网络课程等具有版权的视频，采取加密防止视频被非法下载和传播的措施。
云点播分别在 [视频加密综述](https://cloud.tencent.com/document/product/266/43632) 和 [视频加密接入指引](https://cloud.tencent.com/document/product/266/43633) 中详细介绍了视频加密的原理和接入方式。

```java
//私有加密播放需填写 psign， psign 即超级播放器签名，签名介绍和生成方式参见链接：https://cloud.tencent.com/document/product/266/42436
SuperPlayerModel *model = [[SuperPlayerModel alloc] init];
model.appId = 1400329071;// 配置 AppId
model.videoId = [[SuperPlayerVideoId alloc] init];
model.videoId.fileId = @"5285890799710173650"; // 配置 FileId
model.videoId.pSign = @"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6MTQwMDMyOTA3MSwiZmlsZUlkIjoiNTI4NTg5MDc5OTcxMDE3MzY1MCIsImN1cnJlbnRUaW1lU3RhbXAiOjEsImV4cGlyZVRpbWVTdGFtcCI6MjE0NzQ4MzY0NywidXJsQWNjZXNzSW5mbyI6eyJ0IjoiN2ZmZmZmZmYifSwiZHJtTGljZW5zZUluZm8iOnsiZXhwaXJlVGltZVN0YW1wIjoyMTQ3NDgzNjQ3fX0.yJxpnQ2Evp5KZQFfuBBK05BoPpQAzYAWo6liXws-LzU"; 
[_playerView playWithModel:model];
```

运行代码，可以看到视频在手机上播放，并且界面上大部分功能都处于可用状态。
<img src="https://main.qcloudimg.com/raw/128c45edfc77b319475868c21caec2de.png" width="550">



### 选择 FileId[](id:FileId)

视频 FileId 在一般是在视频上传后，由服务器返回：

1. 客户端视频发布后，服务器会返回 FileId 到客户端。
2. 服务端视频上传时，在 [确认上传](https://cloud.tencent.com/document/product/266/9757) 的通知中包含对应的 FileId。

如果文件已存在腾讯云，则可以进入 [媒资管理](https://console.cloud.tencent.com/vod/media) ，找到对应的文件，查看 FileId。如下图所示，ID 即表示 FileId：
![](https://main.qcloudimg.com/raw/1a3677d5fe618227a117d7502be42793.png)



### 打点功能

在播放长视频时，打点信息有助于观众找到感兴趣的点。使用 [修改媒体文件属性](https://cloud.tencent.com/document/product/266/31762) API，通过 AddKeyFrameDescs.N 参数可以为视频设置打点信息。

调用后，播放器的界面会增加新的元素。
<img src="https://main.qcloudimg.com/raw/55ebce6d0c703dafa1ac131e1852e025.png" width="550">


### 小窗播放[](id:smallWindow)

小窗播是指在 App 内，悬浮在主 Window 上的播放器。使用小窗播放非常简单，只需要在适当位置调用下面代码即可：

```java
[SuperPlayerWindow sharedInstance].superPlayer = _playerView; // 设置小窗显示的播放器
[SuperPlayerWindow sharedInstance].backController = self;  // 设置返回的 view controller
[[SuperPlayerWindow sharedInstance] show]; // 悬浮显示
```

<img src="https://main.qcloudimg.com/raw/e3d4336dce1756d6811bd1d5f70ea3f2.png" width="350">

### 退出播放[](id:exitPlayer)

当不需要播放器时，调用`resetPlayer`清理播放器内部状态，释放内存。

```java
[_playerView resetPlayer];
```

## 更多功能[](id:moreFeature)

完整功能可扫码下载视频云工具包体验，或直接运行工程 Demo。
<img src="https://main.qcloudimg.com/raw/12c7da97cc910eda673cb19b66fc7cb3.png" width="150">
