本文针对音视频平台常见的长视频播放场景，推出超级播放器播放长视频教程。用户将掌握如何在web 端、iOS 端、Android 端播放器上播放视频，同时自动切换自适应码流、预览视频缩略图、添加视频打点信息。

## 学习目标
学习本阶段教程，您将掌握
- 如何在云点播转出自适应码流（播放器能够根据当前带宽，动态选择最合适的码率播放）
- 如何在云点播设置视频打点信息
- 如何在云点播使用雪碧图做缩略图
- 如何使用播放器进行播放
阅读之前，请先确保已经学习超级播放器指引的 [阶段1：用超级播放器播放视频](https://cloud.tencent.com/document/product/266/46217) 篇部分，了解云点播 fileid 的概念。

## 操作步骤
### 步骤1：转出自适应码流与雪碧图
本步骤，我们将指导您如何对视频转出自适应码流与雪碧图。
1. 登录 [云点播控制台](https://console.cloud.tencent.com/vod)，选择**视频处理设置**>**模版设置**>**转自适应码流模版**，单击**创建转自适应码流模版**。
![image](https://user-images.githubusercontent.com/28837844/140276258-8a5d1aff-487a-4cda-9521-214bf3f9e23e.png)
通过模版创建用户需要的自适应码流，本文创建一条名为 testAdaptive 的自适应码流模版，总共包含三条子流，分辨率分别为480p,720p和1080p。视频码率、视频帧率、音频码率则保持与原视频一致。
![image](https://user-images.githubusercontent.com/28837844/140277446-4290975a-b037-4f46-8c25-a280b221c652.png)
2. 选择**视频处理设置**>**模版设置**>**截图模版**，单击创建截图模版
![image](https://user-images.githubusercontent.com/28837844/140277652-b3955a3a-27fd-4ae7-b32d-3bc412a2388b.png)
通过模版创建用户需要的雪碧图，本文创建一个名为 testSprite 的雪碧图模版，采样间隔为5%，小图行数：10，小图列数：10。
![image](https://user-images.githubusercontent.com/28837844/140278128-c6d86ea3-1e28-4761-b43a-652cd1c44add.png)
3. 通过任务流，添加自适应码流模版与雪碧图模版。
选择**视频处理设置**>**任务流设置**>**创建任务流**，单击**创建任务流**。
![image](https://user-images.githubusercontent.com/28837844/140278479-41af63e0-a245-40fd-a54a-7a25c8b8df72.png)
通过任务流，添加用户需要处理的任务，本文为展示播放自适应码流过程，创建了一条 testPlayVideo 的任务流，该任务流仅增加了自适应码流模版和雪碧图模版。
![image](https://user-images.githubusercontent.com/28837844/140279232-59183fe0-6031-4f47-90db-a887b90cd768.png)
4. 选择**媒资管理**>**音视频管理**，勾选需要处理的视频，单击**视频处理**>**转自适应码流**>**选择任务流**，发起任务。
![image](https://user-images.githubusercontent.com/28837844/140279652-013ca9f4-5d8c-4714-a318-46b79cfce6c7.png)
5. 至此，我们可以在**音视频管理**>**操作**>**管理**中，能够获取处理后的任务结果。

### 步骤2：增加视频打点信息
本步骤，我们将指导您新增的一组视频打点信息。
1. 进入云点播服务端 API 文档>**媒资管理相关接口**>[**修改媒体文件属性**](https://cloud.tencent.com/document/product/266/31762),单击调试，进入云 API 控制台进行调试
![image](https://user-images.githubusercontent.com/28837844/140281000-145e42da-44ff-4d47-8a8b-929d72f43d2a.png)
2. 通过参数名称 **AddKeyFrameDescs.N** 添加指定视频打点信息
![image](https://user-images.githubusercontent.com/28837844/140282791-d5735e4c-4d4e-444e-8226-74b251dbee45.png)
至此您已经完成了在云端上的操作，此时您在云点播已经转出自适应码流，视频雪碧图和添加了相关视频打点信息。

### 步骤3：播放器端集成
本步骤，我们将指导您在 Web 端、iOS 端、Android 端播放器播放自适应码流、添加缩略图与打点信息。

<dx-tabs>
::: Web 端
待补充
:::
::: iOS 端
用户需要集成视立方超级播放器请参见 [集成指引](https://tcloud-doc.isd.com/document/product/266/58774) ，集成完后，可以**媒资管理**提取上传媒资的 appId 和 fileId 进行播放。

播放器主类为`SuperPlayerView`，创建后即可播放视频：

```xml
// 引入头文件
#import <SuperPlayer/SuperPlayer.h>

// 创建播放器  
_playerView = [[SuperPlayerView alloc] init];
// 设置代理，用于接受事件
_playerView.delegate = self;
// 设置父 View，_playerView 会被自动添加到 holderView 下面
_playerView.fatherView = self.holderView;
```

#### 使用 fileId 播放

```java
SuperPlayerModel *model = [[SuperPlayerModel alloc] init];
model.appId = 1400329073;// 配置 AppId
model.videoId = [[SuperPlayerVideoId alloc] init];
model.videoId.fileId = @"5285890799710670616"; // 配置 FileId
[_playerView playWithModel:model];
```
:::
::: Android 端
集成视立方超级播放器请参考[集成指引](https://tcloud-doc.isd.com/document/product/266/7938) ，集成完后，可以**媒资管理**提取上传媒资的 appId 和 fileId 进行播放。

播放器主类为`SuperPlayerView`，创建后即可播放视频：

#### 1. 在布局文件创建SuperPlayerView

```xml
<!-- 超级播放器-->
<com.tencent.liteav.demo.superplayer.SuperPlayerView
    android:id="@+id/superVodPlayerView"
    android:layout_width="match_parent"
    android:layout_height="200dp" />
```

#### 2. 使用 fileId 播放

```java
//在布局文件引入SuperPlayerView ，然后创建实例
mSuperPlayerView = (SuperPlayerView) findViewById(R.id.superVodPlayerView);
//不开防盗链
SuperPlayerModel model = new SuperPlayerModel();
model.appId = 1400329073;// 配置 AppId
model.videoId = new SuperPlayerVideoId();
model.videoId.fileId = "5285890799710670616"; // 配置 FileId
mSuperPlayerView.playWithModel(model);
```
:::
</dx-tabs>


## 总结

至此，您就可以在播放器查看雪碧图预览、视频打点信息和自动切换动态自适应码流。更多功能请查看[功能说明](https://tcloud-doc.isd.com/document/product/266/61460)





