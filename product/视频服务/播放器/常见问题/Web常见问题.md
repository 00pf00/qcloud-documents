

### 视频播放失败时，如何定位问题？
视频播放失败有多种原因，定位问题的基本思路是：

1. 配置网络抓包，查看网络请求情况。
2. 查看浏览器控制台报错情况。
3. 检查视频格式，使用的浏览器是否支持播放。

### 如何解决在 HTTPS 协议的页面播放 HTTP 协议的视频，被浏览器拦截的问题？
浏览器会处于安全考虑进行拦截。因此，在 HTTP 协议的页面播放 HTTP 的视频，HTTPS 协议的页面播放 HTTPS 的视频。

### 如何解决 CDN 无视频，访问视频地址返回404的问题？
请 [联系我们](https://cloud.tencent.com/document/product/266/19905) 定位并修复 CDN 资源。

### 如何解决访问视频地址返回403，无法加载视频的问题？
需确认是否开启 referer 防盗链或者 key 防盗链，视频播放时是否具备校验参数。

### 如何解决在微信无法播放视频，非微信情况下却可以播放的问题？
微信浏览器会进行拦截，需要通过微信申诉解除拦截。

### 如何解决 PC 端无法播放视频，浏览器控制台报跨域相关错误的问题？
在 PC 端使用 Flash 播放视频时，视频存储服务器需要部署`crossdomain.xml`文件并配置正确的访问策略，以及开启 CORS 支持。

**crossdomain.xml 的作用**
- 位于`www.a.com`域中的 SWF 文件要访问`www.b.com`的文件时，SWF 首先会检查`www.b.com`服务器根目录下是否有`crossdomain.xml`文件，如果没有，则访问不成功；如果`crossdomain.xml`文件存在，且文件内设置了允许`www.a.com`域访问，则通信正常。
- `crossdomain.xml`中配置的是 SWF 文件的域名。

在 PC 端的现代浏览器使用 HTML5 播放 HLS 和 FLV 时，视频服务器需要配置跨域资源共享 [CORS](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS)。
正常情况下，腾讯云服务会自动配置这两项跨域策略，如遇到异常情况请 [联系我们](https://cloud.tencent.com/document/product/266/19905)。



### 如何解决播放器提示视频未转码的问题？
对视频进行转码操作，具体操作请参见 [处理视频](https://cloud.tencent.com/document/product/266/2841#.E5.A4.84.E7.90.86.E8.A7.86.E9.A2.91)，确保视频编码格式为 H.264，视频封装格式为 MP4 或者 HLS。

### 如何解决转码后的视频出现花屏、黑屏、卡顿和无法播放等现象的问题？
需要定位原始视频是否有问题，如果是转码问题请 [联系我们](https://cloud.tencent.com/document/product/266/19905)。

### 浏览器环境不支持播放时会有什么提示？
通常情况下在 Web 端播放视频依赖浏览器自带的解码器，或者 Flash 解码器，不支持播放会出现 error code 为3或4的错误。


### 如何解决无法播放 RTMP 和 FLV 格式的视频，或者无法在 IE 浏览器中播放视频的问题？
播放 RTMP、FLV 格式的视频以及在 IE 中播放视频都依赖 Flash 插件，请安装并启用 Flash 插件。

### 如何解决在 PC 浏览器不支持 Flash 的情况下，使用 H5 方式无法播放 HLS、FLV 格式视频的问题？
不支持 Flash 的情况下，播放器将使用 MSE 播放 HLS、FLV 格式的视频，如浏览器不支持，只能更换或升级浏览器，目前支持通过 MSE 播放 HLS、FLV  格式视频的浏览器有 Edge、Chrome、Firefox 和 Safari11+。

### 如何解决浏览器不支持解码 H.264 或者不支持播放 MP4、HLS 格式视频的问题？
通常出现在部分 PC 软件或者 App 集成精简版本的浏览器内核中，没有对应的视频解码器。在 PC 软件或 App 中升级浏览器内核，或者集成 Flash 插件，并允许调用 Flash 插件。

### 如何解决 HLS 加密视频播放失败的问题？
HLS 加密视频的播放流程有别于常规视频，通常需要确保获取 key 这个步骤是正常的，解决步骤如下：
1. 检查 m3u8 文件格式是否符合规范，获取密钥的地址是否正确，密钥接口服务端鉴权是否正常，密钥接口是否正常返回。
2. 检查密钥长度，确保密钥长度为16字节，并且是能正确解密的密钥。


### <span id = "p1"></span>如何解决视频激活播放后强制全屏的问题？
如需实现页面内（非全屏）播放，需要在 video 标签中加入 playsinline 和 webkit-playsinline 属性，腾讯云播放器默认会在 video 标签中加上 playsinline 和 webkit-playsinline 属性。iOS10+ 识别 playsinline 属性，版本小于10的系统识别 webkit-playsinline 属性。

经测试，在 iOS Safari 中可以实现页面内（内联）播放。Android 端识别 webkit-playsinline，但是由于 Android 的开放性，出现了许多定制浏览器，这些属性不一定生效，例如，在 TBS 内核浏览器（包括不限于微信、手机 QQ，QQ 浏览器）中，可能需要使用同层播放器属性（ [接入文档](https://x5.tencent.com/tbs/guide/video.html) 、[使用说明](https://x5.tencent.com/tbs/guide/web/x5-video.html)），避免系统强制全屏视频。

如果已配置以上提到的属性仍会强制全屏，则通用解决方案无效，需要浏览器厂商提供解决方案。

### 如何解决视频无法被其他元素覆盖的问题？
播放器控件为浏览器自带控件，需要浏览器厂商提供方法解除视频置顶，暂无通用解决方案。

### 如何解决播放器出现多余图标的问题？
可以尝试隐藏 video 标签，当监听到视频开始播放的事件时，再将 video 标签显示。

### 如何解决播放器出现广告、下载、推荐视频等内容的问题？
需要浏览器厂商提供关闭方法，暂无通用解决方案。

### 如何解决 Android 端播放视频不会随着页面滑动的问题？
经测试发现，通过前端方法无法有效解决此类问题，浏览器劫持视频播放后，没有做好优化体验，可以尝试直接使用 video 标签播放（不通过播放器生成）或者尝试使用 Canvas 绘制视频，如果仍无法解决，只能通过升级浏览器来解决。

### 如何解决播放器播放视频时出现黑边的问题？
设置播放器的尺寸比率与视频实际的尺寸比率一致。
例如，视频的分辨率为1280 x 720，播放器的尺寸可以设置为640 x 360或者1280 x 720等，只要满足16:9（1280:720）的宽高比，就能完全显示视频，播放器不会出现黑边。如果视频自带黑边，则需要在转码的时候切掉视频的黑边内容，改变视频的分辨率。

### 如何解决推流端切换横竖屏，播放端不切换的问题？
Web 播放器目前无法检测到推流端进行了横竖屏切换，只能通过其他途径进行处理。
例如，推流开始时是竖屏模式，上行视频宽高比为9:16，Web 播放端播放也是9:16，这时推流设备不断流（是否断流需要推流 SDK 支持）且变成横屏模式，上行视频宽高比变为16:9，如果下行视频也变成16:9，需要将 Web 播放端重新链接才能播放宽高比切换后的视频，这个操作需要外部的接口通知 Web 播放器。 如果下行视频还是9:16，视频将继续按9:16播放。

### 屏幕全屏和网页全屏的区别是什么？

- **屏幕全屏**：是指在屏幕范围内全屏，全屏后只有视频画面内容，看不到浏览器的地址栏等界面，这种全屏需要浏览器提供接口支持。支持屏幕全屏的接口有两种，一种称为 Fullscreen API，通过 Fullscreen API 进入屏幕全屏后的特点是，进入全屏后仍然可以看到由 HTML CSS 组成的播放器界面。另一种接口为 webkitEnterFullScreen，该接口只能作用于 video 标签，通常用于移动端不支持 Fullscreen API 的情况，通过该接口全屏后，播放器界面为系统自带的界面。
- **网页全屏**：是指在网页显示区域范围内全屏，全屏后仍可以看到浏览器的地址栏等界面，通常情况下网页全屏是为了应对浏览器不支持系统全屏而实现类似全屏的一种方式，所以又称伪全屏。该全屏方式由 CSS 实现。

云点播 Web 播放器采用屏幕全屏为主、网页全屏为辅的全屏方案。全屏模式的优先级为 Fullscreen API > webkitEnterFullScreen > 网页全屏。

由于 Flash 逐步被浏览器限制运行，云点播 Web 播放器采用了 HTML5 标准进行开发，并减少对于 Flash 的使用，在部分老旧的浏览器上，全屏功能使用受限制。旧版点播播放器1.0采用 Flash 开发，使用 Flash 插件实现的屏幕全屏。如需在不支持 Fullscreen API 的浏览器进行屏幕全屏，只能使用旧版点播播放器1.0。

目前已知的全屏情况：
- x5 内核（包括 Android 端的微信、手机 QQ 和 QQ 浏览器）：不支持 Fullscreen API，支持 webkitEnterFullScreen，全屏后进入 x5 内核的屏幕全屏模式。
- Android Chrome：支持 Fullscreen API，全屏后进入带有腾讯云播放器 UI 的屏幕全屏模式。
- iOS （包括微信、手机 QQ、Safari）：不支持 Fullscreen API，支持 webkitEnterFullScreen，全屏后进入 iOS 系统 UI 的屏幕全屏模式。
- IE8/9/10：不支持 Fullscreen API，不支持 webkitEnterFullScreen，全屏为网页全屏模式。
- 桌面端微信浏览器：不支持 Fullscreen API，不支持 webkitEnterFullScreen，全屏为网页全屏模式 (macOS 微信浏览器目前不支持任何全屏模式)。
- 其他桌面端现代浏览器：通常支持 Fullscreen API，全屏后进入带有腾讯云播放器 UI 的屏幕全屏模式。

### 如何解决默认全屏播放的问题？
同 [如何解决视频激活播放后强制全屏的问题？](#p1)，参考其解决方案。

### 如何解决在 iOS Hybrid App 的 WebView 中默认全屏播放的问题？
配置 WebView 的参数 allowsInlineMediaPlayback = YES 允许视频行内播放，即禁止 WebView/UiWebView 强制全屏播放视频。

### 如何解决在 iframe 里使用播放器不能全屏的问题？
如果单击全屏按钮无效，则在 iframe 标签里设置属性 allowfullscreen，示例代码：
```
  <iframe allowfullscreen src="" frameborder="0" scrolling="no" width="100%" height="270"></iframe>
```

### 如何解决在 IE8、9、10 浏览器中无法全屏的问题？
在不支持 Full Screen API 的老旧浏览器中，云点播播放器使用 CSS 实现网页全屏，配合浏览器全屏可以实现屏幕全屏效果（浏览器全屏快捷键通常为“F11”），这里需要页面的 CSS 不能限制播放器的页面内全屏样式，如不能设置播放器的父容器`overflow:hidden`。

如果在 iframe 中，播放器无法修改 iframe 外部的 CSS 样式，需要外部页面提供脚本以及样式支持，通常情况下外部页面需要跨域支持，才能实现网页全屏，因此不建议使用 iframe 的方式使用播放器。

>? IE8/9/10 浏览器不支持 Full Screen API ，因此不能通过 Full Screen API 进行屏幕全屏。

### 如何解决拖拽到某个时间点无法播放，或者跳到片头的问题？
避免使用原始视频进行播放，请使用腾讯云转码后的视频进行播放。避免使用 Flash 进行播放，请切换 HTML5 播放模式。如果视频时长过短，关键帧通常只有1个，不支持拖拽播放。

### 如何解决自动播放失败的问题？
在许多浏览器中，都禁止了多媒体文件自动播放，特别是移动端浏览器。部分浏览器允许静音视频或者无音轨视频自动播放，因此可以尝试将播放器设置为静音。对于静音也无法播放的浏览器，暂无解决办法。

### 如何解决在 Hybrid App 的 WebView 中自动播放失败的问题？
需要设置 WebView 关于多媒体自动播放的属性：
- iOS：mediaPlaybackRequiresUserAction = NO
- Android：webView.getSettings().setMediaPlaybackRequiresUserGesture(false)


### 如何解决播放器初始化后看不到视频画面的问题？
Web 播放器是否显示视频的首帧画面取决于该浏览器是否支持，目前并非所有浏览器都支持首帧画面，解决方案为设置视频的封面。

### 如何解决播放器没有变速播放按钮或者变速功能不可用的问题？
目前只有部分现代浏览支持 HTML5 播放模式的变速播放功能，且 Flash 播放模式不支持变速播放，因此不支持 HTML5 模式播放的浏览器也不支持变速播放。
可以优先使用 HTML5 模式播放，如果没有出现变速播放按钮，说明当前播放模式不支持变速播放；如果出现变速播放按钮，但切换没有效果，说明播放器检测到当前浏览器支持设置变速播放接口，但实际设置后没有效果，建议在此浏览器下隐藏变速播放按钮。
