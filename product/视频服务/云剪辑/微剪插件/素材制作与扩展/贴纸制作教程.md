1.4.0版本的微剪播放器开始支持添加贴纸和选择字体。
## 贴纸
### 雪碧图
微剪的贴纸渲染使用雪碧图实现。
雪碧图是一张拼接了所有帧的 png 图，配套一个`spritesheet.json`说明每一帧的位置和尺寸信息。
![](https://cdn-weijian-1258344699.file.myqcloud.com/docs/sticker-doc/heye.png)

### 制作教程

##### Step1 准备贴纸所需的序列帧：

![企业微信截图_be2821a2-920a-42ae-8800-eb5eb655dc1e](https://cdn-weijian-1258344699.file.myqcloud.com/docs/sticker-doc/0.png)



##### Step2 下载[Texture Packer](https://www.codeandweb.com/texturepacker)并安装

![企业微信截图_406406eb-8ac3-4b6f-9e0e-81335692e371](https://cdn-weijian-1258344699.file.myqcloud.com/docs/sticker-doc/1.png)

##### Step3 将序列帧拖入Texture Packer

![企业微信截图_d5c84cce-d082-4d30-8c56-965df308db28](https://cdn-weijian-1258344699.file.myqcloud.com/docs/sticker-doc/2.png)

小程序WebGL对纹理支持最大尺寸为2048*2048，因此需要对过大的精灵图进行缩放。

选择左侧精灵列表所有的精灵，右键->精灵设置，调整精灵的缩放（缩放依实际情况而定，建议最终缩放完的尺寸在单张200-400之间）：

> ?如果有数量比较多的序列帧，建议开发者自行做一层过滤，避免序列帧过多导致放不下。

![企业微信截图_5324a5ca-c271-4988-8507-bf3f159a8001](https://cdn-weijian-1258344699.file.myqcloud.com/docs/sticker-doc/3.png)



##### Step4 设置输出文件框架为PIXI.js，然后选择输入路径

![企业微信截图_79ddf3f8-3561-4904-847f-24d387ad382f](https://cdn-weijian-1258344699.file.myqcloud.com/docs/sticker-doc/4.png)

![企业微信截图_b5578f44-070d-44bb-a85e-e2a11d8725da](https://cdn-weijian-1258344699.file.myqcloud.com/docs/sticker-doc/6.png)

> ? 导出的精灵图名称和json文件名称请务必保持一致。

##### Step5 点击“发布精灵表”导出

![企业微信截图_a46a47e9-c8a7-4b01-81c1-1d932868745a](https://cdn-weijian-1258344699.file.myqcloud.com/docs/sticker-doc/5.png)

##### Step6 打包

将heye.json和heye.png放在heye文件夹下，并将heye文件夹打成zip包。

##### Step7 将Zip包上传CDN

将打好的zip包上传你的资源服务地址，然后传入播放器即可完成贴纸自定义。

这里假设得到的资源地址为:  `https://xxxxx.heye.zip`

### 内置&&渲染

制作完成贴纸之后就可以注册到微剪渲染了。

##### 1.配置自定义资源

前面生成了`heye`贴纸，现在将它合并到播放器内置资源中（如果界面无需展示内资资源则可以直接覆盖）。

首先，获取播放器内置贴纸。

参考： [内置资源](xxxxxxx)

```javascript
let stickerList = await plugin.getStickerList();

stickerList.tabs[0].list.push({
    key: 'heye',
    name: '荷叶',
    previewImage: 'https://xxxxx.heye.png',
    zipUrl: 'https://xxxxx.heye.zip'
});
```

调用`pugin`实例的`initPlugin`方法，更新setting配置。

```javascript
plugin.initPlugin({
    source: {
        stickers: stickerList
    }
});
```

##### 2.渲染

```javascript
   let stickerclip = new global['wj-types'].Clip({
     id: 'heye',
     type: 'sticker',
     section: {
       start: 0,
       end: 10,
       duration: 10
     },
     designSize: {
        xPercent: 0.20, //初始位置
        yPercent: 0.30,
        rotation: 0.4, // 旋转角度（单位弧度）
        scale: 2 // 缩放尺寸
     },
     startAt: 0,
     key: 'heye',  // 贴纸key
   })
```

