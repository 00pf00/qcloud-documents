## 操作场景
TSF 的日志服务，提供日志投递功能。您可通过配置日志投递规则，并将其发布至目标部署组，从而实现部署组日志的转存。

## 操作步骤
### 新建日志投递规则
1. 登录 [TSF控制台](https://console.cloud.tencent.com/tsf/index) 
2. 在左侧菜单栏中，单击运维中心下的【日志服务】>【日志配置】页面后，点击 [日志投递](https://console.cloud.tencent.com/tsf/log-config?rid=19&tab=delivery) tab标签
3. 点击页面中规则列表上方的【新建投递规则】按钮，在弹出的【新建投递规则弹框】中输入您的规则设置
	- 规则名称：必填，文本，长度限制64个字符
	- 日志采集路径：必填，至少需输入一个路径，长度限制256个字符
		- 可通过“添加”按钮添加多个路径输入框，以设置多个路径
	- 接收端：日志转存至的目标位置
		- 仅支持设置一个接收端
		- 本期仅支持CKafka类型的接收端，需设置IP、端口号和Topic

![](https://main.qcloudimg.com/raw/ca3bd3c7d9e5c7eca6e73bc5e4885559.jpg)

> 注：
- 所配置的CKafka必须和应用部署的vpc相同
- 请在CKafka上开启白名单，以保证日志采集端和kafka的网络联通性
- 日志采集路径请勿以/data/tsf_apm开头

4. 绑定部署组
规则创建完成后，您可将规则绑定至多个部署组。绑定后，此投递规则即会在所选的部署组中生效，部署组中规则指定路径下的日志，会被自动转存至目标接收端

![](https://main.qcloudimg.com/raw/4586d03765256fb421b1ed7bbd741ae5.jpg)

### 查看日志投递规则详情
日志投递规则创建后，会以列表项的形式呈现在【日志投递】页面的规则列表中。点击某列表项中的【规则ID】，可进入该规则的详情页，查看规则的详细信息
![](https://main.qcloudimg.com/raw/4cc48995b5e3d459efd1e0cddf2b35ad.jpg)
您可在规则详情页中，查看到其基本信息和发布情况（规则已绑定的部署组列表）
![](https://main.qcloudimg.com/raw/6d50c485761c22187e0b6b3647d84c23.jpg)
### 发布日志投递规则
投递规则创建完成后，您可通过【发布规则】将投递规则绑定至更多部署组
- 操作入口
	- 方式一：在投递规则列表页中找到目标规则 > 点击【操作】列中的【发布规则】按钮
	- 方式二：进入目标规则的【规则详情】>【发布情况】页中，点击左上方的【发布规则】按钮
- 选择所需绑定的部署组，并提交即可

![](https://main.qcloudimg.com/raw/49284dee16c0bae4e0961f305952e353.jpg)

> 已绑定当前规则的部署组不可被选中；已绑定其它规则的部署组，被绑定新规则时，部署组的投递规则被替换为新的规则
### 修改部署组的投递规则
您可通过以下方式，修改部署组所绑定的投递规则
- 方式一：您可通过将新的规则绑定至部署组，替换其原有投递规则
- 方式二：在部署组的详情页的【基本信息】中，编辑其投递规则；选择新的规则并保存后，部署组的投递规则即更新为新选的规则

![](https://main.qcloudimg.com/raw/e21c908256a64f071f6bca5f969c47d8.jpg)
### 编辑日志投递规则
规则创建成功后，您可随时修改规则的配置信息
- 在规则列表页中找到所需修改的规则项，点击ID进入其详情页
- 点击详情页【基本信息】卡片右上方的“编辑”按钮，在打开的【编辑投递规则弹框】中，编辑规则配置项后，提交保存即可
- 规则修改完成后，自动在规则已绑定的部署组中生效

![](https://main.qcloudimg.com/raw/ab7ac7ec900acadd5fceaeb5cdd5ff9c.jpg)
![](https://main.qcloudimg.com/raw/b65e70b8425b4d730ff59671bf9b4354.jpg)

### 删除日志投递规则
投递规则创建后，您也可以随时将其删除

- 操作步骤：在投递规则列表页中找到目标规则 > 点击【操作】列中的【更多】按钮 > 点击所弹出菜单中的【删除】按钮，确认后即将规则删除
- 规则删除后，自动把该规则从所有已绑定该规则的部署组中清除，并停止此规则的日志投递

![](https://main.qcloudimg.com/raw/d3a11d9445bf008bdec1105084628c23.jpg)
