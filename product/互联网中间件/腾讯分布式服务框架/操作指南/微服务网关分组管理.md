## 操作场景
微服务网关通过分组管理微服务 API。
分组是微服务网关管理 API 的维度，同一个分组下的 API 使用相同的鉴权方法，使用相同的一个或者多个密钥进行访问鉴权。每一个分组有一个固定的 context 作为访问路径中的 path 参数。

## 操作步骤
### 新建分组

1. 登录 [TSF 控制台](https://console.cloud.tencent.com/tsf)，在左侧菜单栏选择【微服务网关】>【分组管理】。
2. 在分组管理页面，单击左上角的【新建分组】。
3. 填写分组名称和访问 context， 选择鉴权类型。
	- 分组名称：	最长为60个字符，只能包含小写字母、数字及分隔符（`_`、`-`），且不能以分隔符开头或结尾。
	- 访问 context：context 是用户访问网关管理的某一个 API 的路径的路径参数。以“/”开头，不能为空。
	- 鉴权类型：密钥鉴权或无鉴权。当选择密钥对鉴权时，请求参数中不带正确的 SecretId 和签名的访问会被拒绝。

![](https://main.qcloudimg.com/raw/fdf3e10ccf43c6441d411b320cd0f060.png)

4. 单击【提交】，
5. 将分组与微服务网关应用的部署组进行绑定。只有将网关应用的部署组与分组绑定后，才能保证访问部署组IP后与对应API path访问畅通。



### 删除分组
在 [分组管理](https://console.cloud.tencent.com/tsf/api-group) 中，单击操作列的【删除】可以删除分组。
>?如果分组下有 API，则该分组不能被删除。



### 导入API

1. 点击分组详情

2. 点击API列表，选择导入API

3. 选择API

   ![](https://main.qcloudimg.com/raw/66f9f9dab619c474cd116fb6a31b81d8.png)

4. 点击提交


### 发布分组

当且仅当分组被发布时，才能通过微服务网关访问微服务API。导入API后，需要点击分组列表，将分组发布。若某一个分组不想被访问，需要将分组下线。



### 访问微服务API

当分组发布后，使用什么样的路径能够访问微服务API呢？

分组下的某个API的访问路径为：

网关的域名或网关的ip+port/分组context/微服务API所在的微服务命名空间名称/微服务名称/API路径

举例：当分组context为 sell 时，所在命名空间为 test-env，微服务名称为consumer，API路径为 /echo/{test}

则访问路径为  域名/sell/test-env/consumer/echo/{test}

点击API路径后面的复制按钮，会自动复制 从context以后的路径。

粘贴后的内容为/sell/test/provider-demo/v1/user/delete/user



### 微服务网关域名

在用户公有云场景下，需要用户将部署网关的节点的ip配置在 DNS 或 LB 上，以获取统一的访问网关的统一域名或统一VIP。

- 对虚拟机部署组，用户可以将虚拟机部署组的机器IP绑定在CLB后端。
- 对容器部署组，用户可以设置容器部署组的访问方式为公网访问。





